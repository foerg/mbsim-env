<?xml version="1.0" encoding="UTF-8"?>
<xs:schema targetNamespace="http://mbsim.berlios.de/MBSimHydraulics"
  elementFormDefault="qualified"
  attributeFormDefault="unqualified"
  xmlns="http://mbsim.berlios.de/MBSimHydraulics"
  xmlns:mbsim="http://mbsim.berlios.de/MBSim"
  xmlns:mbsimcontrol="http://mbsim.berlios.de/MBSimControl"
  xmlns:pv="http://openmbv.berlios.de/MBXMLUtils/physicalvariable"
  xmlns:ombv="http://openmbv.berlios.de/OpenMBV"
  xmlns:xs="http://www.w3.org/2001/XMLSchema">

  <xs:import namespace="http://openmbv.berlios.de/MBXMLUtils/physicalvariable"
    schemaLocation="@MBXMLUTILSSCHEMA@/physicalvariable.xsd"/>

  <xs:import namespace="http://openmbv.berlios.de/OpenMBV"
    schemaLocation="@OPENMBVCPPINTERFACESCHEMA@/openmbv.xsd"/>

  <xs:import namespace="http://mbsim.berlios.de/MBSim"/>
  <xs:import namespace="http://mbsim.berlios.de/MBSimControl"/>

  <xs:simpleType name="HLineReferenceType">
    <xs:restriction base="xs:token">
      <!-- pattern value="/?((\.\.|Group\[X\])/)*HLine\[X\]" with
      X=((([a-zA-Z_]|[a-zA-Z_][a-zA-Z0-9_]*[a-zA-Z_])\{[^\}]+\})+([a-zA-Z_][a-zA-Z0-9_]*)?|[a-zA-Z_][a-zA-Z0-9_]*)
      from physicalvariable.xsd name attribute -->
      <xs:pattern value="/?((\.\.|Group\[((([a-zA-Z_]|[a-zA-Z_][a-zA-Z0-9_]*[a-zA-Z_])\{[^\}]+\})+([a-zA-Z_][a-zA-Z0-9_]*)?|[a-zA-Z_][a-zA-Z0-9_]*)\])/)*HLine\[((([a-zA-Z_]|[a-zA-Z_][a-zA-Z0-9_]*[a-zA-Z_])\{[^\}]+\})+([a-zA-Z_][a-zA-Z0-9_]*)?|[a-zA-Z_][a-zA-Z0-9_]*)\]"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:element name="HydraulicEnvironment" substitutionGroup="mbsim:Environment" type="HydraulicEnvironmentType"/>
  <xs:complexType name="HydraulicEnvironmentType">
    <xs:complexContent>
      <xs:extension base="mbsim:EnvironmentType">
        <xs:sequence>
          <xs:element name="environmentPressure" type="pv:nounitScalar"/>
          <xs:element name="specificMass">
            <xs:complexType>
              <xs:choice>
                <xs:element name="constantSpecificMass" type="pv:nounitScalar"/>
                <xs:element name="volumeDependingOnTemperature">
                  <xs:complexType>
                    <xs:sequence>
                      <xs:element name="dVdT" type="pv:nounitScalar"/>
                      <xs:element name="basicSpecificMass" type="pv:nounitScalar"/>
                      <xs:element name="basicTemperature" type="pv:nounitScalar"/>
                    </xs:sequence>
                  </xs:complexType>
                </xs:element>
                <xs:element name="specificMassDependingOnTemperature">
                  <xs:complexType>
                    <xs:sequence>
                      <xs:element name="dRhodT" type="pv:nounitScalar"/>
                      <xs:element name="basicSpecificMass" type="pv:nounitScalar"/>
                      <xs:element name="basicTemperature" type="pv:nounitScalar"/>
                    </xs:sequence>
                  </xs:complexType>
                </xs:element>
              </xs:choice>
            </xs:complexType>
          </xs:element>
          <xs:element name="kinematicViscosity">
            <xs:complexType>
              <xs:choice>
                <xs:element name="constantKinematicViscosity" type="pv:nounitScalar"/>
                <xs:element name="walterUbbeohdeKinematicViscosity">
                  <xs:complexType>
                    <xs:sequence>
                      <xs:element name="temperature1" type="pv:nounitScalar"/>
                      <xs:element name="kinematicViscosity1" type="pv:nounitScalar"/>
                      <xs:element name="temperature2" type="pv:nounitScalar"/>
                      <xs:element name="kinematicViscosity2" type="pv:nounitScalar"/>
                    </xs:sequence>
                  </xs:complexType>
                </xs:element>
              </xs:choice>
            </xs:complexType>
          </xs:element>
          <xs:element name="basicBulkModulus" type="pv:nounitScalar"/>
          <xs:element name="kappa" type="pv:nounitScalar"/>
          <xs:element name="fluidTemperature" type="pv:nounitScalar"/>
        </xs:sequence> 
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>   

  <xs:element name="PressureLoss" abstract="true" substitutionGroup="mbsim:Function1_SS" type="PressureLossType">
    <xs:annotation>
      <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
        Abstrakte Klasse zur Berechnung von Druckverlusten
      </xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="PressureLossType">
    <xs:complexContent>
      <xs:extension base="mbsim:Function1_SSType"/>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="LinePressureLoss" abstract="true" substitutionGroup="PressureLoss" type="LinePressureLossType">
  </xs:element>
  <xs:complexType name="LinePressureLossType">
    <xs:complexContent>
      <xs:extension base="PressureLossType"/>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="ZetaLinePressureLoss" substitutionGroup="LinePressureLoss" type="ZetaLinePressureLossType">
    <xs:annotation>
      <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
        Druckverluste aufgrund Ein-/Auslaufverluste sowie Umlenkverluste.<br/>
        Die Berechnung erfolgt gemäß
        <object class="eqn">\Delta p = \frac{\rho}{2} \, \zeta \, \frac{Q \, |Q|}{A^2}</object>
      </xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="ZetaLinePressureLossType">
    <xs:complexContent>
      <xs:extension base="LinePressureLossType">
        <xs:sequence>
          <xs:element name="zeta" type="pv:nounitScalar">
            <xs:annotation>
              <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                Druckverlustzahl <object class="inlineeqn">\zeta</object>
              </xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="LaminarTubeFlowLinePressureLoss" substitutionGroup="LinePressureLoss" type="LaminarTubeFlowLinePressureLossType">
    <xs:annotation>
      <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
        Druckverluste aufgrund laminarer Rohrströmung.<br/>
        Die Berechnung erfolgt gemäß
        <object class="eqn">\Delta p = 32 \, \eta \, \frac{l}{d^2} \, \frac{Q}{A}</object>
      </xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="LaminarTubeFlowLinePressureLossType">
    <xs:complexContent>
      <xs:extension base="LinePressureLossType"/>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="CurveFittedLinePressureLoss" substitutionGroup="LinePressureLoss" type="CurveFittedLinePressureLossType">
    <xs:annotation>
      <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
        Für hydraulische Bauteile einer gewissen Komplexität sind die Druckverlustfaktoren aus tabellarischen Naschlagewerken oft nur sehr ungenau bis gar nicht zu bestimmen. Dagegen kann für jedes Bauteil durch eine Messung bzw. CFD-Simulation der Druckverlust in Abhängigkeit der Reynoldszahl bestimmt werden. Die Reynoldszahl sollte hierbei möglichst im Bezug auf den engsten Querschnitt als Referenzquerschnitt <object class="inlineeqn">A_r</object> mit dem hydraulischen Durchmesser <object class="inlineeqn">D_H</object> bestimmt werden <br/>
        Für jedes hydraulische Bauteil setzt sich der Durckverlust bei laminarer Strömung aus einem Anteil der Umlenkverluste und einem Anteil der Reibungsverluste zusammen
        <object class="eqn">\Delta p = \Delta p_{Umlenk} + \Delta p_{Reibung} = \frac{\rho}{2} \, \left( \sum_i \zeta_i \, \frac{Q \, |Q|}{A^2} + \sum_j \lambda_j \, \frac{l_j}{d_j} \, \frac{Q \, |Q|}{A^2} \right)</object>
        mit den konstante Faktoren <object class="inlineeqn">\zeta_i</object> für die Umlenkstellen und der Rohrreibungszahl <object class="inlineeqn">\lambda_j</object> f+r die jeweiligen Leitungsabschnitte des Bauelements.<br/>
        Die Reynoldszahl am Referenzquerschnitt wird über die Beziehung
        <object class="eqn">Re = \frac{D_{H,R}}{\nu} \, \frac{Q}{A}</object>
        bestimmt.
        Ausgehend von den Mess- bzw. Simulationsdaten können dann mittels Curvefitting die Parameter <object class="inlineeqn">a</object> und <object class="inlineeqn">b</object> für die folgende Approximationsfunktion in Abhängigkeit von der Reynoldszahl bestimmt werden:
        <object class="eqn">\Delta p = \rho \, \nu^2 \, \left( a \, Re_R + b \, Re_R^2 \right)</object>
        mit
        <object class="eqn">a= \sum_i 32 \, \frac{l_i}{d_i^2 \, D_{H,R}} \, \frac{A_R}{A_i}</object>
        <object class="eqn">b= \sum_i \frac{\zeta_i}{2 \, D_{H,R}^2} \, \left( \frac{A_R}{A_i} \right)^2</object>
        Ab einer Reynoldszahl von <object class="inlineeqn">Re>2300</object> kann es zu turbulenten Strömungszuständen kommen. Abhängig von deren Ausprägung im Bauteil verschlechtert sich die Aussagegenauigkeit des Modells.
      </xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="CurveFittedLinePressureLossType">
    <xs:complexContent>
      <xs:extension base="LinePressureLossType">
        <xs:sequence>
          <xs:element name="referenceDiameter" type="pv:nounitScalar"/>
          <xs:element name="hydraulicDiameter" type="pv:nounitScalar"/>
          <xs:element name="aPositive" type="pv:nounitScalar"/>
          <xs:element name="bPositive" type="pv:nounitScalar"/>
          <xs:element name="aNegative" type="pv:nounitScalar"/>
          <xs:element name="bNegative" type="pv:nounitScalar"/>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="ClosablePressureLoss" abstract="true" substitutionGroup="PressureLoss" type="ClosablePressureLossType">
    <xs:annotation>
      <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
        Abstrakte Klasse zur Berechnung von Druckverlusten mit veränderlichen Koeffizienten und einer Sperrmöglichkeit.
      </xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="ClosablePressureLossType">
    <xs:complexContent>
      <xs:extension base="PressureLossType"/>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="RelativeAreaZetaClosablePressureLoss" substitutionGroup="ClosablePressureLoss" type="RelativeAreaZetaClosablePressureLossType"/>
  <xs:complexType name="RelativeAreaZetaClosablePressureLossType">
    <xs:complexContent>
      <xs:extension base="ClosablePressureLossType">
        <xs:sequence>
          <xs:element name="zeta" type="pv:nounitScalar"/>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="RelativeAlphaClosablePressureLoss" substitutionGroup="ClosablePressureLoss" type="RelativeAlphaClosablePressureLossType"/>
  <xs:complexType name="RelativeAlphaClosablePressureLossType">
    <xs:complexContent>
      <xs:extension base="ClosablePressureLossType">
        <xs:sequence>
          <xs:element name="alpha" type="pv:nounitScalar"/>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="CheckvalveClosablePressureLoss" abstract="true" substitutionGroup="ClosablePressureLoss" type="CheckvalveClosablePressureLossType"/>
  <xs:complexType name="CheckvalveClosablePressureLossType">
    <xs:complexContent>
      <xs:extension base="ClosablePressureLossType">
        <xs:sequence>
          <xs:element name="ballRadius" type="pv:nounitScalar"/>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="GammaCheckvalveClosablePressureLoss" substitutionGroup="CheckvalveClosablePressureLoss" type="GammaCheckvalveClosablePressureLossType"/>
  <xs:complexType name="GammaCheckvalveClosablePressureLossType">
    <xs:complexContent>
      <xs:extension base="CheckvalveClosablePressureLossType">
        <xs:sequence>
          <xs:element name="alpha" type="pv:nounitScalar"/>
          <xs:element name="gamma" type="pv:nounitScalar"/>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="IdelchickCheckvalveClosablePressreLoss" substitutionGroup="CheckvalveClosablePressureLoss" type="IdelchickCheckvalveClosablePressreLossType"/>
  <xs:complexType name="IdelchickCheckvalveClosablePressreLossType">
    <xs:complexContent>
      <xs:extension base="CheckvalveClosablePressureLossType"/>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="ConeCheckvalveClosablePressureLoss" substitutionGroup="CheckvalveClosablePressureLoss" type="ConeCheckvalveClosablePressureLossType"/>
  <xs:complexType name="ConeCheckvalveClosablePressureLossType">
    <xs:complexContent>
      <xs:extension base="CheckvalveClosablePressureLossType">
        <xs:sequence>
          <xs:element name="alpha" type="pv:nounitScalar"/>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="LeakagePressureLoss" substitutionGroup="PressureLoss" abstract="true" type="LeakagePressureLossType">
  </xs:element>
  <xs:complexType name="LeakagePressureLossType">
    <xs:complexContent>
      <xs:extension base="PressureLossType"/>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="PlaneLeakagePressureLoss" substitutionGroup="LeakagePressureLoss" type="PlaneLeakagePressureLossType">
    <xs:annotation>
      <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
        Modell eines ebenen Leckagespaltes.
        Der Druckverlust berechnet sich zu
        <object class="eqn">p_V = \frac{12 \, \eta \, |l|}{b \, h^3} \left[ Q + \frac{h \, b}{2} \, \left(v_1 + v_2\right) \right]</object>
        Die Länge des Leckagespaltes wird dabei entweder konstant gehalten oder an die Länge des gapLength-Signals angepasst. Die Geschwindigkeiten v1 und v2 entsprechen den Geschwindigkeiten der beiden anderen Signaleingänge. Dieser Summand wird nur berücksichtigt, falls die Signaleingänge gesetzt sind.
        Als Geschwindigkeit muss die Geschwindigkeit der Grenzflächen in Richtung der Länge l angegeben werden.
      </xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="PlaneLeakagePressureLossType">
    <xs:complexContent>
      <xs:extension base="LeakagePressureLossType">
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="CircularLeakagePressureLoss" abstract="true" substitutionGroup="LeakagePressureLoss" type="CircularLeakagePressureLossType">
  </xs:element>
  <xs:complexType name="CircularLeakagePressureLossType">
    <xs:complexContent>
      <xs:extension base="LeakagePressureLossType"/>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="EccentricCircularLeakagePressureLoss" substitutionGroup="CircularLeakagePressureLoss" type="EccentricCircularLeakagePressureLossType">
    <xs:annotation>
      <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
        Strömung durch einen kreisförmigen Leckagespalt.
        Der Druckverlust berechnet sich zu
        <object class="eqn">p_V = \frac{|l|}{\alpha \, A} \, Q - \frac{|l|}{2 \, \alpha} \, \left(\dot x_i + \dot x_a \right)</object>
        mit 
        <object class="eqn">\alpha = \frac{A \, h^2}{12 \, \nu} \, \left( 1 + 1.5 \, \epsilon \right)</object>
        Die Länge des Leckagespaltes wird dabei entweder konstant gehalten oder an die Länge des gapLength-Signals angepasst. Die Geschwindigkeiten v1 und v2 entsprechen den Geschwindigkeiten der beiden anderen Signaleingänge. Dieser Summand wird nur berücksichtigt, falls die Signaleingänge gesetzt sind.
        Als Geschwindigkeit muss die Geschwindigkeit der Grenzflächen in Richtung der Länge l angegeben werden.
      </xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="EccentricCircularLeakagePressureLossType">
    <xs:complexContent>
      <xs:extension base="CircularLeakagePressureLossType">
        <xs:sequence>
          <xs:element name="eccentricity" type="pv:nounitScalar">
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="RealCircularLeakagePressureLoss" substitutionGroup="CircularLeakagePressureLoss" type="RealCircularLeakagePressureLossType">
    <xs:annotation>
      <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
      </xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="RealCircularLeakagePressureLossType">
    <xs:complexContent>
      <xs:extension base="CircularLeakagePressureLossType"/>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="HLine" abstract="true" substitutionGroup="mbsim:Object" type="HLineType"/>
  <xs:complexType name="HLineType">
    <xs:complexContent>
      <xs:extension base="mbsim:ObjectType">
        <xs:sequence>
          <xs:element name="direction" type="pv:nounitVector">
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="RigidHLine" abstract="true" substitutionGroup="HLine" type="RigidHLineType"/>
  <xs:complexType name="RigidHLineType">
    <xs:complexContent>
      <xs:extension base="HLineType">
        <xs:sequence>
          <xs:element name="length" type="pv:lengthScalar">
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="RigidLine" substitutionGroup="RigidHLine" type="RigidLineType">
  </xs:element>
  <xs:complexType name="RigidLineType">
    <xs:complexContent>
      <xs:extension base="RigidHLineType">
        <xs:sequence>
          <xs:element name="diameter" type="pv:lengthScalar">
          </xs:element>
          <xs:element name="linePressureLoss">
            <xs:complexType>
              <xs:sequence>
                <xs:element ref="LinePressureLoss"/>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="ClosableRigidLine" substitutionGroup="RigidLine" type="ClosableRigidLineType">
  </xs:element>
  <xs:complexType name="ClosableRigidLineType">
    <xs:complexContent>
      <xs:extension base="RigidLineType">
        <xs:sequence>
          <xs:element name="closablePressureLoss">
            <xs:complexType>
              <xs:sequence>
                <xs:element ref="ClosablePressureLoss"/>
                <xs:element name="checksizeSignal">
                  <xs:complexType>
                    <xs:attribute name="ref" type="mbsimcontrol:SignalReferenceType" use="required"/>
                  </xs:complexType>
                </xs:element>
                <xs:element name="minimalChecksizeValue"/>
                <xs:element name="setValued"/>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="LeakageLine" substitutionGroup="RigidHLine" type="LeakageLineType">
  </xs:element>
  <xs:complexType name="LeakageLineType">
    <xs:complexContent>
      <xs:extension base="RigidHLineType">
        <xs:sequence>
          <xs:element name="firstSurfaceVelocity" minOccurs="0">
            <xs:complexType>
              <xs:attribute name="ref" type="mbsimcontrol:SignalReferenceType" use="required"/>
            </xs:complexType>
          </xs:element>
          <xs:element name="secondSurfaceVelocity" minOccurs="0">
            <xs:complexType>
              <xs:attribute name="ref" type="mbsimcontrol:SignalReferenceType" use="required"/>
            </xs:complexType>
          </xs:element>
          <xs:element name="gapLength" minOccurs="0">
            <xs:complexType>
              <xs:attribute name="ref" type="mbsimcontrol:SignalReferenceType" use="required"/>
            </xs:complexType>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="PlaneLeakageLine" substitutionGroup="LeakageLine" type="PlaneLeakageLineType">
  </xs:element>
  <xs:complexType name="PlaneLeakageLineType">
    <xs:complexContent>
      <xs:extension base="LeakageLineType">
        <xs:sequence>
          <xs:element name="width" type="pv:lengthScalar">
          </xs:element>
          <xs:element name="height" type="pv:lengthScalar">
          </xs:element>
          <xs:element name="planeLeakagePressureLoss">
            <xs:complexType>
              <xs:sequence>
                <xs:element ref="PlaneLeakagePressureLoss"/>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="CircularLeakageLine" substitutionGroup="LeakageLine" type="CircularLeakageLineType">
  </xs:element>
  <xs:complexType name="CircularLeakageLineType">
    <xs:complexContent>
      <xs:extension base="LeakageLineType">
        <xs:sequence>
          <xs:element name="innerRadius" type="pv:lengthScalar">
          </xs:element>
          <xs:element name="height" type="pv:lengthScalar">
          </xs:element>
          <xs:element name="circularLeakagePressureLoss">
            <xs:complexType>
              <xs:sequence>
                <xs:element ref="CircularLeakagePressureLoss"/>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="HNode" abstract="true" substitutionGroup="mbsim:Link" type="HNodeType"/>
  <xs:complexType name="HNodeType">
    <xs:complexContent>
      <xs:extension base="mbsim:LinkType">
        <xs:sequence>
          <xs:choice minOccurs="0" maxOccurs="unbounded">
            <xs:element name="inflow">
              <xs:complexType>
                <xs:attribute name="ref" type="HLineReferenceType" use="required"/>
              </xs:complexType>
            </xs:element>
            <xs:element name="outflow">
              <xs:complexType>
                <xs:attribute name="ref" type="HLineReferenceType" use="required"/>
              </xs:complexType>
            </xs:element>
          </xs:choice>
        </xs:sequence> 
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="ConstrainedNode" substitutionGroup="HNode" type="ConstrainedNodeType">
  </xs:element>
  <xs:complexType name="ConstrainedNodeType">
    <xs:complexContent>
      <xs:extension base="HNodeType">
        <xs:sequence>
          <xs:element name="function">
            <xs:complexType>
              <xs:sequence>
                <xs:element ref="mbsim:Function1_SS">
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="EnvironmentNode" substitutionGroup="HNode" type="EnvironmentNodeType">
  </xs:element>
  <xs:complexType name="EnvironmentNodeType">
    <xs:complexContent>
      <xs:extension base="HNodeType"/>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="ElasticNode" substitutionGroup="HNode" type="ElasticNodeType">
  </xs:element>
  <xs:complexType name="ElasticNodeType">
    <xs:complexContent>
      <xs:extension base="HNodeType">
        <xs:sequence>
          <xs:element name="volume" type="pv:nounitScalar"/>
          <xs:element name="initialPressure" type="pv:nounitScalar"/>
          <xs:element name="fracAir" type="pv:nounitScalar"/>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="RigidNode" substitutionGroup="HNode" type="RigidNodeType">
  </xs:element>
  <xs:complexType name="RigidNodeType">
    <xs:complexContent>
      <xs:extension base="HNodeType"/>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="HNodeMec" abstract="true" substitutionGroup="HNode" type="HNodeMecType"/>
  <xs:complexType name="HNodeMecType">
    <xs:complexContent>
      <xs:extension base="HNodeType">
        <xs:sequence>
          <xs:element name="initialVolume" type="pv:nounitScalar"/>
          <xs:choice minOccurs="0" maxOccurs="unbounded">
            <xs:element name="translatorialBoundarySourface">
              <xs:complexType>
                <xs:sequence>
                  <xs:element name="frameOfReference">
                    <xs:complexType>
                      <xs:attribute name="ref" type="mbsim:FrameReferenceType" use="required"/>
                    </xs:complexType>
                  </xs:element>
                  <xs:element name="normal" type="pv:nounitVector"/>
                  <xs:element name="area" type="pv:nounitScalar"/>
                  <xs:element name="noVolumeChange" minOccurs="0"/>
                </xs:sequence>
              </xs:complexType>
            </xs:element>
            <xs:element name="rotatorialBoundarySourface">
              <xs:complexType>
                <xs:sequence>
                  <xs:element name="frameOfReference">
                    <xs:complexType>
                      <xs:attribute name="ref" type="mbsim:FrameReferenceType" use="required"/>
                    </xs:complexType>
                  </xs:element>
                  <xs:element name="normal" type="pv:nounitVector"/>
                  <xs:element name="area" type="pv:nounitScalar"/>
                  <xs:element name="frameOfRotationCenter">
                    <xs:complexType>
                      <xs:attribute name="ref" type="mbsim:FrameReferenceType" use="required"/>
                    </xs:complexType> 
                  </xs:element>
                  <xs:element name="noVolumeChange" minOccurs="0"/>
                </xs:sequence>
              </xs:complexType>
            </xs:element>
          </xs:choice>
          <xs:element name="enableOpenMBVArrows" minOccurs="0">
            <xs:complexType>
              <xs:sequence>
                <xs:element name="size" type="pv:nounitScalar"/>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
        </xs:sequence> 
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="ConstrainedNodeMec" substitutionGroup="HNodeMec" type="ConstrainedNodeMecType">
  </xs:element>
  <xs:complexType name="ConstrainedNodeMecType">
    <xs:complexContent>
      <xs:extension base="HNodeMecType">
        <xs:sequence>
          <xs:element name="function">
            <xs:complexType>
              <xs:sequence>
                <xs:element ref="mbsim:Function1_SS">
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="EnvironmentNodeMec" substitutionGroup="HNodeMec" type="EnvironmentNodeMecType">
  </xs:element>
  <xs:complexType name="EnvironmentNodeMecType">
    <xs:complexContent>
      <xs:extension base="HNodeMecType"/>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="ElasticNodeMec" substitutionGroup="HNodeMec" type="ElasticNodeMecType"/>
  <xs:complexType name="ElasticNodeMecType">
    <xs:complexContent>
      <xs:extension base="HNodeMecType">
        <xs:sequence>
          <xs:element name="initialPressure" type="pv:nounitScalar"/>
          <xs:element name="fracAir" type="pv:nounitScalar"/>
        </xs:sequence> 
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>   

  <xs:element name="RigidNodeMec" substitutionGroup="HNodeMec" type="RigidNodeMecType">
  </xs:element>
  <xs:complexType name="RigidNodeMecType">
    <xs:complexContent>
      <xs:extension base="HNodeMecType"/>
    </xs:complexContent>
  </xs:complexType>


  <xs:element name="Controlvalve43" substitutionGroup="mbsim:EmptyGroup" type="Controlvalve43Type">
  </xs:element>
  <xs:complexType name="Controlvalve43Type">
    <xs:complexContent>
      <xs:extension base="mbsim:EmptyGroupType">
        <xs:sequence>
          <xs:element name="frameOfReference">
            <xs:complexType>
              <xs:attribute name="ref" type="mbsim:FrameReferenceType" use="required"/>
            </xs:complexType> 
          </xs:element>
          <xs:element name="valve">
            <xs:complexType>
              <xs:sequence>
                <xs:element name="length" type="pv:lengthScalar"/>
                <xs:element name="diameter" type="pv:lengthScalar"/>
                <xs:element name="alpha" type="pv:nounitScalar"/>
                <xs:element name="relativeAreaPA">
                  <xs:complexType>
                    <xs:sequence>
                      <xs:element ref="mbsim:Function1_SS">
                      </xs:element>
                    </xs:sequence>
                  </xs:complexType>
                </xs:element>
                <xs:element name="minimalRelativeArea" type="pv:nounitScalar"/>
                <xs:element name="setValued" minOccurs="0"/>
                <xs:element name="offset" type="pv:nounitScalar"/>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
          <xs:element name="relativePosition">
            <xs:complexType>
              <xs:attribute name="ref" type="mbsimcontrol:SignalReferenceType" use="required"/>
            </xs:complexType>
          </xs:element>
          <xs:element name="lineP">
            <xs:complexType>
              <xs:sequence>
                <xs:element name="direction" type="pv:nounitVector">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Richtungsvektor der Zuleitung zu P
                    </xs:documentation>
                  </xs:annotation>
                </xs:element>
                <xs:element name="length" type="pv:lengthScalar">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Länge der Zuleitung zu P
                    </xs:documentation>
                  </xs:annotation>
                </xs:element>
                <xs:element name="diameter" type="pv:lengthScalar">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Durchmesser der Zuleitung zu P
                    </xs:documentation>
                  </xs:annotation>
                </xs:element>
                <xs:element name="linePressureLoss" minOccurs="0">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Druckverluste in der Zuleitung zu P
                    </xs:documentation>
                  </xs:annotation>
                  <xs:complexType>
                    <xs:sequence>
                      <xs:element ref="LinePressureLoss"/>
                    </xs:sequence>
                  </xs:complexType>
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
          <xs:element name="lineA">
            <xs:complexType>
              <xs:sequence>
                <xs:element name="direction" type="pv:nounitVector">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Richtungsvektor der Ableitung von A
                    </xs:documentation>
                  </xs:annotation>
                </xs:element>
                <xs:element name="length" type="pv:lengthScalar">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Länge der Ableitung von A
                    </xs:documentation>
                  </xs:annotation>
                </xs:element>
                <xs:element name="diameter" type="pv:lengthScalar">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Durchmesser der Ableitung von A
                    </xs:documentation>
                  </xs:annotation>
                </xs:element>
                <xs:element name="linePressureLoss" minOccurs="0">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Druckverluste in der Ableitung von A
                    </xs:documentation>
                  </xs:annotation>
                  <xs:complexType>
                    <xs:sequence>
                      <xs:element ref="LinePressureLoss"/>
                    </xs:sequence>
                  </xs:complexType>
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
          <xs:element name="lineB">
            <xs:complexType>
              <xs:sequence>
                <xs:element name="direction" type="pv:nounitVector">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Richtungsvektor der Ableitung von B
                    </xs:documentation>
                  </xs:annotation>
                </xs:element>
                <xs:element name="length" type="pv:lengthScalar">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Länge der Ableitung von B
                    </xs:documentation>
                  </xs:annotation>
                </xs:element>
                <xs:element name="diameter" type="pv:lengthScalar">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Durchmesser der Ableitung von B
                    </xs:documentation>
                  </xs:annotation>
                </xs:element>
                <xs:element name="linePressureLoss" minOccurs="0">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Druckverluste in der Ableitung von B
                    </xs:documentation>
                  </xs:annotation>
                  <xs:complexType>
                    <xs:sequence>
                      <xs:element ref="LinePressureLoss"/>
                    </xs:sequence>
                  </xs:complexType>
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
          <xs:element name="lineT">
            <xs:complexType>
              <xs:sequence>
                <xs:element name="direction" type="pv:nounitVector">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Richtungsvektor der Ableitung von T
                    </xs:documentation>
                  </xs:annotation>
                </xs:element>
                <xs:element name="length" type="pv:lengthScalar">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Länge der Ableitung von T
                    </xs:documentation>
                  </xs:annotation>
                </xs:element>
                <xs:element name="diameter" type="pv:lengthScalar">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Durchmesser der Ableitung von T
                    </xs:documentation>
                  </xs:annotation>
                </xs:element>
                <xs:element name="linePressureLoss" minOccurs="0">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Druckverluste in der Ableitung von T
                    </xs:documentation>
                  </xs:annotation>
                  <xs:complexType>
                    <xs:sequence>
                      <xs:element ref="LinePressureLoss"/>
                    </xs:sequence>
                  </xs:complexType>
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="Checkvalve" abstract="true" substitutionGroup="mbsim:EmptyGroup" type="CheckvalveType">
    <xs:annotation>
      <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
        Abstrakte Klasse eines Rückschlagventils
      </xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="CheckvalveType">
    <xs:complexContent>
      <xs:extension base="mbsim:EmptyGroupType"/>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="BallCheckvalve" substitutionGroup="Checkvalve" type="BallCheckvalveType">
    <xs:annotation>
      <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
        Modell eines Rückschlagventils mit Berücksichtigung der Trägheit der Ventilkugel.<br/>
        Die an die Blende angeschlossenen hydraulischen Knoten müssen vom Typ <tt>HydNodeMec</tt> sein, da ihnen automatisch hydraulisch-mechanische Grenzflächen zur Berechnung der Kräfte auf die Ventilkugel zugewiesen werden. Die Fläche der Grenzfläche ist dabei abhängig vom gewählten Druckverlustmodell der Blende.
      </xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="BallCheckvalveType">
    <xs:complexContent>
      <xs:extension base="CheckvalveType">
        <xs:sequence>
          <xs:element name="basisFrame">
            <xs:annotation>
              <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                Koordinatensystem, in dem das Rückschlagventil berechnet wird.
              </xs:documentation>
            </xs:annotation>
            <xs:complexType>
              <xs:attribute name="ref" type="mbsim:FrameReferenceType" use="required"/>
            </xs:complexType> 
          </xs:element>
          <xs:element name="RigidLine">
            <xs:annotation>
              <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                Daten der Blende
              </xs:documentation>
            </xs:annotation>
            <xs:complexType>
              <xs:sequence>
                <xs:element name="length" type="pv:lengthScalar">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Länge der Blende
                    </xs:documentation>
                  </xs:annotation>
                </xs:element>
                <xs:element name="diameter" type="pv:lengthScalar">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Durchmesser der Blende
                    </xs:documentation>
                  </xs:annotation>
                </xs:element>
                <xs:element name="checkvalvePressureLoss">
                  <xs:complexType>
                    <xs:sequence>
                      <xs:element ref="CheckvalveClosablePressureLoss">
                        <xs:annotation>
                          <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                            Druckverlust des Rückschlagventils.
                          </xs:documentation>
                        </xs:annotation>
                      </xs:element>
                      <xs:element name="minimalXOpen" type="pv:lengthScalar">
                        <xs:annotation>
                          <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                            Numerische Schranke für die minimale Öffnungshöhe des Kugelventils.
                          </xs:documentation>
                        </xs:annotation>
                      </xs:element>
                      <xs:element name="setValued" minOccurs="0">
                        <xs:annotation>
                          <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                            Berechnung des Rückschlagventils mit einem Eckengesetz.
                          </xs:documentation>
                        </xs:annotation>
                      </xs:element>
                    </xs:sequence>
                  </xs:complexType>
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
          <xs:element name="Ball">
            <xs:annotation>
              <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                Daten der Ventilkugel
              </xs:documentation>
            </xs:annotation>
            <xs:complexType>
              <xs:sequence>
                <xs:element name="mass" type="pv:massScalar">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Masse der Ventilkugel. <br/>
                      Die Massenträgheit der Ventilkugel wird gemäß  <object class="inlineeqn">\Theta_{Ball}=\frac{2}{5} \, m_{Ball} \, r_{Ball}^2</object>. berechnet.
                    </xs:documentation>
                  </xs:annotation>
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
          <xs:element name="Spring">
            <xs:annotation>
              <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                Ventilfeder
              </xs:documentation>
            </xs:annotation>
            <xs:complexType>
              <xs:sequence>
                <xs:element name="forceFunction">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Kraftgesetz der Feder. Die Einbaulänge der Feder entspricht der maximalen Ventilöffnungshöhe.
                    </xs:documentation>
                  </xs:annotation>
                  <xs:complexType>
                    <xs:sequence>
                      <xs:element ref="mbsim:Function2_SSS"/>
                    </xs:sequence>
                  </xs:complexType> 
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
          <xs:element name="SeatContact">
            <xs:annotation>
              <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                Modellierung des Kontaktes zwischen Kugel und Ventilsitz.
              </xs:documentation>
            </xs:annotation>
            <xs:complexType>
              <xs:sequence>
                <xs:element name="contactForceLaw">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Kraftgesetz
                    </xs:documentation>
                  </xs:annotation>
                  <xs:complexType>
                    <xs:sequence>
                      <xs:element ref="mbsim:GeneralizedForceLaw"/>
                    </xs:sequence>
                  </xs:complexType>
                </xs:element>
                <xs:element name="contactImpactLaw">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Kraftgesetz zur Lösung der Nebenbedingungen auf Impulsebene.
                    </xs:documentation>
                  </xs:annotation>
                  <xs:complexType>
                    <xs:sequence>
                      <xs:element ref="mbsim:GeneralizedImpactLaw" minOccurs="0"/>
                    </xs:sequence>
                  </xs:complexType>
                </xs:element>
              </xs:sequence> 
            </xs:complexType>
          </xs:element>
          <xs:element name="maximalOpening" type="pv:lengthScalar">
            <xs:annotation>
              <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                Maximale Öffnungshöhe der Ventilkugel
              </xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element name="MaximalOpeningContact">
            <xs:complexType>
              <xs:sequence>
                <xs:element name="contactForceLaw">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Kraftgesetz
                    </xs:documentation>
                  </xs:annotation>
                  <xs:complexType>
                    <xs:sequence>
                      <xs:element ref="mbsim:GeneralizedForceLaw"/>
                    </xs:sequence>
                  </xs:complexType>
                </xs:element>
                <xs:element name="contactImpactLaw">
                  <xs:annotation>
                    <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                      Kraftgesetz zur Lösung der Nebenbedingungen auf Impulsebene.
                    </xs:documentation>
                  </xs:annotation>
                  <xs:complexType>
                    <xs:sequence>
                      <xs:element ref="mbsim:GeneralizedImpactLaw" minOccurs="0"/>
                    </xs:sequence>
                  </xs:complexType>
                </xs:element>
              </xs:sequence> 
            </xs:complexType>
          </xs:element>
          <xs:element name="enableOpenMBVBodies" minOccurs="0">
            <xs:annotation>
              <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                Visualisierung der Körper des Rückschlagventils
              </xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element name="enableOpenMBVFrames" minOccurs="0">
            <xs:annotation>
              <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                Visualisierung der internen Koordinatensyteme des Rückschlagventils
              </xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element name="enableOpenMBVArrows" minOccurs="0">
            <xs:annotation>
              <xs:documentation xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
                Visualisierung der Kräfte des Rückschlagventils
              </xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

</xs:schema>
