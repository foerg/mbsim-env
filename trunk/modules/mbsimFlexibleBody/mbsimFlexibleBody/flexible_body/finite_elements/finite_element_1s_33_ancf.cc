/* Copyright (C) 2004-2014 MBSim Development Team
 *
 * This library is free software; you can redistribute it and/or 
 * modify it under the terms of the GNU Lesser General Public 
 * License as published by the Free Software Foundation; either 
 * version 2.1 of the License, or (at your option) any later version. 
 *  
 * This library is distributed in the hope that it will be useful, 
 * but WITHOUT ANY WARRANTY; without even the implied warranty of 
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU 
 * Lesser General Public License for more details. 
 *  
 * You should have received a copy of the GNU Lesser General Public 
 * License along with this library; if not, write to the Free Software 
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301 USA
 *
 * Contact: thorsten.schindler@mytum.de
 */

#include <config.h>
#include "mbsimFlexibleBody/flexible_body/finite_elements/finite_element_1s_33_ancf.h"
#include "mbsimFlexibleBody/flexible_body/finite_elements/finite_element_1s_21_ancf.h"
#include "mbsim/utils/rotarymatrices.h"
#include "mbsim/utils/eps.h"

using namespace std;
using namespace fmatvec;
using namespace MBSim;

namespace MBSimFlexibleBody {

  FiniteElement1s33ANCF::FiniteElement1s33ANCF(double sl0, double srho, double sE, double sG, double sA, double sI0, double sI1, double sI2, Vec sg) :l0(sl0), rho(srho), E(sE), G(sG), A(sA), I0(sI0), I1(sI1), I2(sI2), wss01(0.), wss02(0.), depsilon(0.), g(sg), M(12,INIT,0.), h(12,INIT,0.), Damp(12,INIT,0.), Dhq(12,INIT,0.), Dhqp(12,INIT,0.) {}

  FiniteElement1s33ANCF::~FiniteElement1s33ANCF() {
  }

  void FiniteElement1s33ANCF::setCurlRadius(double R1, double R2) {
    if (fabs(R1) > epsroot()) {
      wss01 = 1/R1;
    }
    if (fabs(R2) > epsroot()) {
      wss02 = 1/R2;
    }
  }

  void FiniteElement1s33ANCF::setMaterialDamping(double depsilons) {
    throw MBSim::MBSimError("Error(FiniteElement1s33ANCF::setMaterialDamping): Not implemented");
    //  depsilon  += depsilons;
    //  Damp(3,3) += -depsilon;
  }

  void FiniteElement1s33ANCF::setLehrDamping(double D) {
    throw MBSim::MBSimError("Error(FiniteElement1s33ANCF::setLehrDamping): Not implemented");
    //  // Longitudinaleifenfrequenz
    //  double weps = sqrt(12.*EA/(Arho*l0h2));
    //  // Biegeeigenfrequenz
    //  double wbL  = sqrt(1260.*128.*EI/(197.*Arho*l0h4));

    //  depsilon  = 1.0 * D * weps * (Arho*l0h3/12.);
    //  Damp(3,3) = -depsilon;
  }

  void FiniteElement1s33ANCF::initM() {
    M(0,0) = A*l0*rho*(1.3E1/3.5E1);
    M(0,3) = A*(l0*l0)*rho*(1.1E1/2.1E2);
    M(0,6) = A*l0*rho*(9.0/7.0E1);
    M(0,9) = A*(l0*l0)*rho*(-1.3E1/4.2E2);
    M(1,1) = A*l0*rho*(1.3E1/3.5E1);
    M(1,4) = A*(l0*l0)*rho*(1.1E1/2.1E2);
    M(1,7) = A*l0*rho*(9.0/7.0E1);
    M(1,10) = A*(l0*l0)*rho*(-1.3E1/4.2E2);
    M(2,2) = A*l0*rho*(1.3E1/3.5E1);
    M(2,5) = A*(l0*l0)*rho*(1.1E1/2.1E2);
    M(2,8) = A*l0*rho*(9.0/7.0E1);
    M(2,11) = A*(l0*l0)*rho*(-1.3E1/4.2E2);
    M(3,3) = A*(l0*l0*l0)*rho*(1.0/1.05E2);
    M(3,6) = A*(l0*l0)*rho*(1.3E1/4.2E2);
    M(3,9) = A*(l0*l0*l0)*rho*(-1.0/1.4E2);
    M(4,4) = A*(l0*l0*l0)*rho*(1.0/1.05E2);
    M(4,7) = A*(l0*l0)*rho*(1.3E1/4.2E2);
    M(4,10) = A*(l0*l0*l0)*rho*(-1.0/1.4E2);
    M(5,5) = A*(l0*l0*l0)*rho*(1.0/1.05E2);
    M(5,8) = A*(l0*l0)*rho*(1.3E1/4.2E2);
    M(5,11) = A*(l0*l0*l0)*rho*(-1.0/1.4E2);
    M(6,6) = A*l0*rho*(1.3E1/3.5E1);
    M(6,9) = A*(l0*l0)*rho*(-1.1E1/2.1E2);
    M(7,7) = A*l0*rho*(1.3E1/3.5E1);
    M(7,10) = A*(l0*l0)*rho*(-1.1E1/2.1E2);
    M(8,8) = A*l0*rho*(1.3E1/3.5E1);
    M(8,11) = A*(l0*l0)*rho*(-1.1E1/2.1E2);
    M(9,9) = A*(l0*l0*l0)*rho*(1.0/1.05E2);
    M(10,10) = A*(l0*l0*l0)*rho*(1.0/1.05E2);
    M(11,11) = A*(l0*l0*l0)*rho*(1.0/1.05E2);
  }

  void FiniteElement1s33ANCF::computeh(const Vec& qElement, const Vec& qpElement) {
    // Coordinates
    const double & x1 = qElement(0);    const double & y1 = qElement(1);     const double & z1 = qElement(2);
    const double &dx1 = qElement(3);    const double &dy1 = qElement(4);     const double &dz1 = qElement(5);
    const double & x2 = qElement(6);    const double & y2 = qElement(7);     const double & z2 = qElement(8);
    const double &dx2 = qElement(9);    const double &dy2 = qElement(10);    const double &dz2 = qElement(11);

    // Gravitation
    double gx = g(0);
    double gy = g(1);
    double gz = g(2);

    Vec hgrav(12,NONINIT);
    hgrav(0) = A*gx*l0*rho*(1.0/2.0);
    hgrav(1) = A*gy*l0*rho*(1.0/2.0);
    hgrav(2) = A*gz*l0*rho*(1.0/2.0);
    hgrav(3) = A*gx*(l0*l0)*rho*(1.0/1.2E1);
    hgrav(4) = A*gy*(l0*l0)*rho*(1.0/1.2E1);
    hgrav(5) = A*gz*(l0*l0)*rho*(1.0/1.2E1);
    hgrav(6) = A*gx*l0*rho*(1.0/2.0);
    hgrav(7) = A*gy*l0*rho*(1.0/2.0);
    hgrav(8) = A*gz*l0*rho*(1.0/2.0);
    hgrav(9) = A*gx*(l0*l0)*rho*(-1.0/1.2E1);
    hgrav(10) = A*gy*(l0*l0)*rho*(-1.0/1.2E1);
    hgrav(11) = A*gz*(l0*l0)*rho*(-1.0/1.2E1);

    // Interior forces
    // Local coordinate system
    Vec e1(3,NONINIT);
    e1(0) = x2-x1; e1(1) = y2-y1; e1(2) = z2-z1;
    e1 /= nrm2(e1);
    const double &e1x = e1(0); const double &e1y = e1(1); const double &e1z = e1(2);

    Mat dvec1dq(3,12,INIT,0.);
    dvec1dq(0,0) = -1.; dvec1dq(0,6) = 1.;
    dvec1dq(1,1) = -1.; dvec1dq(1,7) = 1.;
    dvec1dq(2,2) = -1.; dvec1dq(2,8) = 1.;

    Mat de1dq = differentiate_normalized_vector_respective_vector(e1)*dvec1dq;

    Vec e2(3,NONINIT);
    e2(0) = y1-y2; e2(1) = x2-x1; e2(2) = 0.;
    e2 /= nrm2(e2);
    const double &e2x = e2(0); const double &e2y = e2(1); const double &e2z = e2(2);

    Mat dvec2dq(3,12,INIT,0.);
    dvec2dq(0,1) = 1.; dvec2dq(0,7) = -1.;
    dvec2dq(1,0) = -1.; dvec2dq(1,6) = 1.;

    Mat de2dq = differentiate_normalized_vector_respective_vector(e2)*dvec2dq;

    Vec e3 = crossProduct(e1,e2);
    const double &e3x = e3(0); const double &e3y = e3(1); const double &e3z = e3(2);

    Mat de3dq = tilde(e1)*de2dq - tilde(e2)*de1dq;

    // Strain
    Vec hst_q(12,NONINIT);
    hst_q(0) = (A*E*e1x*(l0*1.0E1+e1x*x1*1.2E1-e1x*x2*1.2E1+e1y*y1*1.2E1-e1y*y2*1.2E1+e1z*z1*1.2E1-e1z*z2*1.2E1+dx1*e1x*l0+dx2*e1x*l0+dy1*e1y*l0+dy2*e1y*l0+dz1*e1z*l0+dz2*e1z*l0)*(-1.0/1.0E1))/l0;
    hst_q(1) = (A*E*e1y*(l0*1.0E1+e1x*x1*1.2E1-e1x*x2*1.2E1+e1y*y1*1.2E1-e1y*y2*1.2E1+e1z*z1*1.2E1-e1z*z2*1.2E1+dx1*e1x*l0+dx2*e1x*l0+dy1*e1y*l0+dy2*e1y*l0+dz1*e1z*l0+dz2*e1z*l0)*(-1.0/1.0E1))/l0;
    hst_q(2) = (A*E*e1z*(l0*1.0E1+e1x*x1*1.2E1-e1x*x2*1.2E1+e1y*y1*1.2E1-e1y*y2*1.2E1+e1z*z1*1.2E1-e1z*z2*1.2E1+dx1*e1x*l0+dx2*e1x*l0+dy1*e1y*l0+dy2*e1y*l0+dz1*e1z*l0+dz2*e1z*l0)*(-1.0/1.0E1))/l0;
    hst_q(3) = A*E*e1x*(e1x*x1*3.0-e1x*x2*3.0+e1y*y1*3.0-e1y*y2*3.0+e1z*z1*3.0-e1z*z2*3.0+dx1*e1x*l0*4.0-dx2*e1x*l0+dy1*e1y*l0*4.0-dy2*e1y*l0+dz1*e1z*l0*4.0-dz2*e1z*l0)*(-1.0/3.0E1);
    hst_q(4) = A*E*e1y*(e1x*x1*3.0-e1x*x2*3.0+e1y*y1*3.0-e1y*y2*3.0+e1z*z1*3.0-e1z*z2*3.0+dx1*e1x*l0*4.0-dx2*e1x*l0+dy1*e1y*l0*4.0-dy2*e1y*l0+dz1*e1z*l0*4.0-dz2*e1z*l0)*(-1.0/3.0E1);
    hst_q(5) = A*E*e1z*(e1x*x1*3.0-e1x*x2*3.0+e1y*y1*3.0-e1y*y2*3.0+e1z*z1*3.0-e1z*z2*3.0+dx1*e1x*l0*4.0-dx2*e1x*l0+dy1*e1y*l0*4.0-dy2*e1y*l0+dz1*e1z*l0*4.0-dz2*e1z*l0)*(-1.0/3.0E1);
    hst_q(6) = (A*E*e1x*(l0*1.0E1+e1x*x1*1.2E1-e1x*x2*1.2E1+e1y*y1*1.2E1-e1y*y2*1.2E1+e1z*z1*1.2E1-e1z*z2*1.2E1+dx1*e1x*l0+dx2*e1x*l0+dy1*e1y*l0+dy2*e1y*l0+dz1*e1z*l0+dz2*e1z*l0)*(1.0/1.0E1))/l0;
    hst_q(7) = (A*E*e1y*(l0*1.0E1+e1x*x1*1.2E1-e1x*x2*1.2E1+e1y*y1*1.2E1-e1y*y2*1.2E1+e1z*z1*1.2E1-e1z*z2*1.2E1+dx1*e1x*l0+dx2*e1x*l0+dy1*e1y*l0+dy2*e1y*l0+dz1*e1z*l0+dz2*e1z*l0)*(1.0/1.0E1))/l0;
    hst_q(8) = (A*E*e1z*(l0*1.0E1+e1x*x1*1.2E1-e1x*x2*1.2E1+e1y*y1*1.2E1-e1y*y2*1.2E1+e1z*z1*1.2E1-e1z*z2*1.2E1+dx1*e1x*l0+dx2*e1x*l0+dy1*e1y*l0+dy2*e1y*l0+dz1*e1z*l0+dz2*e1z*l0)*(1.0/1.0E1))/l0;
    hst_q(9) = A*E*e1x*(e1x*x1*3.0-e1x*x2*3.0+e1y*y1*3.0-e1y*y2*3.0+e1z*z1*3.0-e1z*z2*3.0-dx1*e1x*l0+dx2*e1x*l0*4.0-dy1*e1y*l0+dy2*e1y*l0*4.0-dz1*e1z*l0+dz2*e1z*l0*4.0)*(-1.0/3.0E1);
    hst_q(10) = A*E*e1y*(e1x*x1*3.0-e1x*x2*3.0+e1y*y1*3.0-e1y*y2*3.0+e1z*z1*3.0-e1z*z2*3.0-dx1*e1x*l0+dx2*e1x*l0*4.0-dy1*e1y*l0+dy2*e1y*l0*4.0-dz1*e1z*l0+dz2*e1z*l0*4.0)*(-1.0/3.0E1);
    hst_q(11) = A*E*e1z*(e1x*x1*3.0-e1x*x2*3.0+e1y*y1*3.0-e1y*y2*3.0+e1z*z1*3.0-e1z*z2*3.0-dx1*e1x*l0+dx2*e1x*l0*4.0-dy1*e1y*l0+dy2*e1y*l0*4.0-dz1*e1z*l0+dz2*e1z*l0*4.0)*(-1.0/3.0E1);
    
    Vec hst_e1(3,NONINIT);
    hst_e1(0) = (A*E*(l0*x1*3.0E1-l0*x2*3.0E1+e1x*(x1*x1)*3.6E1+e1x*(x2*x2)*3.6E1+(dx1*dx1)*e1x*(l0*l0)*4.0+(dx2*dx2)*e1x*(l0*l0)*4.0-e1x*x1*x2*7.2E1+e1y*x1*y1*3.6E1-e1y*x1*y2*3.6E1-e1y*x2*y1*3.6E1+e1y*x2*y2*3.6E1+e1z*x1*z1*3.6E1-e1z*x1*z2*3.6E1-e1z*x2*z1*3.6E1+e1z*x2*z2*3.6E1+dx1*e1x*l0*x1*6.0-dx1*e1x*l0*x2*6.0+dx2*e1x*l0*x1*6.0-dx2*e1x*l0*x2*6.0+dy1*e1y*l0*x1*3.0-dy1*e1y*l0*x2*3.0+dy2*e1y*l0*x1*3.0-dy2*e1y*l0*x2*3.0+dz1*e1z*l0*x1*3.0-dz1*e1z*l0*x2*3.0+dz2*e1z*l0*x1*3.0-dz2*e1z*l0*x2*3.0+dx1*e1y*l0*y1*3.0-dx1*e1y*l0*y2*3.0+dx2*e1y*l0*y1*3.0-dx2*e1y*l0*y2*3.0+dx1*e1z*l0*z1*3.0-dx1*e1z*l0*z2*3.0+dx2*e1z*l0*z1*3.0-dx2*e1z*l0*z2*3.0-dx1*dx2*e1x*(l0*l0)*2.0+dx1*dy1*e1y*(l0*l0)*4.0-dx1*dy2*e1y*(l0*l0)-dx2*dy1*e1y*(l0*l0)+dx2*dy2*e1y*(l0*l0)*4.0+dx1*dz1*e1z*(l0*l0)*4.0-dx1*dz2*e1z*(l0*l0)-dx2*dz1*e1z*(l0*l0)+dx2*dz2*e1z*(l0*l0)*4.0)*(-1.0/3.0E1))/l0;
    hst_e1(1) = (A*E*(l0*y1*3.0E1-l0*y2*3.0E1+e1y*(y1*y1)*3.6E1+e1y*(y2*y2)*3.6E1+(dy1*dy1)*e1y*(l0*l0)*4.0+(dy2*dy2)*e1y*(l0*l0)*4.0+e1x*x1*y1*3.6E1-e1x*x1*y2*3.6E1-e1x*x2*y1*3.6E1+e1x*x2*y2*3.6E1-e1y*y1*y2*7.2E1+e1z*y1*z1*3.6E1-e1z*y1*z2*3.6E1-e1z*y2*z1*3.6E1+e1z*y2*z2*3.6E1+dy1*e1x*l0*x1*3.0-dy1*e1x*l0*x2*3.0+dy2*e1x*l0*x1*3.0-dy2*e1x*l0*x2*3.0+dx1*e1x*l0*y1*3.0-dx1*e1x*l0*y2*3.0+dx2*e1x*l0*y1*3.0-dx2*e1x*l0*y2*3.0+dy1*e1y*l0*y1*6.0-dy1*e1y*l0*y2*6.0+dy2*e1y*l0*y1*6.0-dy2*e1y*l0*y2*6.0+dz1*e1z*l0*y1*3.0-dz1*e1z*l0*y2*3.0+dz2*e1z*l0*y1*3.0-dz2*e1z*l0*y2*3.0+dy1*e1z*l0*z1*3.0-dy1*e1z*l0*z2*3.0+dy2*e1z*l0*z1*3.0-dy2*e1z*l0*z2*3.0+dx1*dy1*e1x*(l0*l0)*4.0-dx1*dy2*e1x*(l0*l0)-dx2*dy1*e1x*(l0*l0)+dx2*dy2*e1x*(l0*l0)*4.0-dy1*dy2*e1y*(l0*l0)*2.0+dy1*dz1*e1z*(l0*l0)*4.0-dy1*dz2*e1z*(l0*l0)-dy2*dz1*e1z*(l0*l0)+dy2*dz2*e1z*(l0*l0)*4.0)*(-1.0/3.0E1))/l0;
    hst_e1(2) = (A*E*(l0*z1*3.0E1-l0*z2*3.0E1+e1z*(z1*z1)*3.6E1+e1z*(z2*z2)*3.6E1+(dz1*dz1)*e1z*(l0*l0)*4.0+(dz2*dz2)*e1z*(l0*l0)*4.0+e1x*x1*z1*3.6E1-e1x*x1*z2*3.6E1-e1x*x2*z1*3.6E1+e1x*x2*z2*3.6E1+e1y*y1*z1*3.6E1-e1y*y1*z2*3.6E1-e1y*y2*z1*3.6E1+e1y*y2*z2*3.6E1-e1z*z1*z2*7.2E1+dz1*e1x*l0*x1*3.0-dz1*e1x*l0*x2*3.0+dz2*e1x*l0*x1*3.0-dz2*e1x*l0*x2*3.0+dz1*e1y*l0*y1*3.0-dz1*e1y*l0*y2*3.0+dz2*e1y*l0*y1*3.0-dz2*e1y*l0*y2*3.0+dx1*e1x*l0*z1*3.0-dx1*e1x*l0*z2*3.0+dx2*e1x*l0*z1*3.0-dx2*e1x*l0*z2*3.0+dy1*e1y*l0*z1*3.0-dy1*e1y*l0*z2*3.0+dy2*e1y*l0*z1*3.0-dy2*e1y*l0*z2*3.0+dz1*e1z*l0*z1*6.0-dz1*e1z*l0*z2*6.0+dz2*e1z*l0*z1*6.0-dz2*e1z*l0*z2*6.0+dx1*dz1*e1x*(l0*l0)*4.0-dx1*dz2*e1x*(l0*l0)-dx2*dz1*e1x*(l0*l0)+dx2*dz2*e1x*(l0*l0)*4.0+dy1*dz1*e1y*(l0*l0)*4.0-dy1*dz2*e1y*(l0*l0)-dy2*dz1*e1y*(l0*l0)+dy2*dz2*e1y*(l0*l0)*4.0-dz1*dz2*e1z*(l0*l0)*2.0)*(-1.0/3.0E1))/l0;
    
    // Curvature
    Vec hcu_q(12,NONINIT);
    hcu_q(0) = 1.0/(l0*l0*l0)*(E*I1*(e3x*e3x)*x1*2.0+E*I2*(e2x*e2x)*x1*2.0-E*I1*(e3x*e3x)*x2*2.0-E*I2*(e2x*e2x)*x2*2.0+G*I0*(e3y*e3y)*x1*2.0-G*I0*(e3y*e3y)*x2*2.0+E*I2*e2x*e2y*y1*2.0+E*I1*e3x*e3y*y1*2.0-E*I2*e2x*e2y*y2*2.0-E*I1*e3x*e3y*y2*2.0+E*I2*e2x*e2z*z1*2.0+E*I1*e3x*e3z*z1*2.0-E*I2*e2x*e2z*z2*2.0-E*I1*e3x*e3z*z2*2.0-G*I0*e3x*e3y*y1*2.0+G*I0*e3x*e3y*y2*2.0+E*I1*dx1*(e3x*e3x)*l0+E*I2*dx1*(e2x*e2x)*l0+E*I1*dx2*(e3x*e3x)*l0+E*I2*dx2*(e2x*e2x)*l0+G*I0*dx1*(e3y*e3y)*l0+G*I0*dx2*(e3y*e3y)*l0+E*I2*dy1*e2x*e2y*l0+E*I1*dy1*e3x*e3y*l0+E*I2*dy2*e2x*e2y*l0+E*I1*dy2*e3x*e3y*l0+E*I2*dz1*e2x*e2z*l0+E*I1*dz1*e3x*e3z*l0+E*I2*dz2*e2x*e2z*l0+E*I1*dz2*e3x*e3z*l0-G*I0*dy1*e3x*e3y*l0-G*I0*dy2*e3x*e3y*l0)*-6.0;
    hcu_q(1) = 1.0/(l0*l0*l0)*(E*I1*(e3y*e3y)*y1*2.0+E*I2*(e2y*e2y)*y1*2.0-E*I1*(e3y*e3y)*y2*2.0-E*I2*(e2y*e2y)*y2*2.0+G*I0*(e3x*e3x)*y1*2.0-G*I0*(e3x*e3x)*y2*2.0+E*I2*e2x*e2y*x1*2.0+E*I1*e3x*e3y*x1*2.0-E*I2*e2x*e2y*x2*2.0-E*I1*e3x*e3y*x2*2.0-G*I0*e3x*e3y*x1*2.0+G*I0*e3x*e3y*x2*2.0+E*I2*e2y*e2z*z1*2.0+E*I1*e3y*e3z*z1*2.0-E*I2*e2y*e2z*z2*2.0-E*I1*e3y*e3z*z2*2.0+E*I1*dy1*(e3y*e3y)*l0+E*I2*dy1*(e2y*e2y)*l0+E*I1*dy2*(e3y*e3y)*l0+E*I2*dy2*(e2y*e2y)*l0+G*I0*dy1*(e3x*e3x)*l0+G*I0*dy2*(e3x*e3x)*l0+E*I2*dx1*e2x*e2y*l0+E*I1*dx1*e3x*e3y*l0+E*I2*dx2*e2x*e2y*l0+E*I1*dx2*e3x*e3y*l0+E*I2*dz1*e2y*e2z*l0+E*I1*dz1*e3y*e3z*l0+E*I2*dz2*e2y*e2z*l0+E*I1*dz2*e3y*e3z*l0-G*I0*dx1*e3x*e3y*l0-G*I0*dx2*e3x*e3y*l0)*-6.0;
    hcu_q(2) = E*1.0/(l0*l0*l0)*(I1*(e3z*e3z)*z1*2.0+I2*(e2z*e2z)*z1*2.0-I1*(e3z*e3z)*z2*2.0-I2*(e2z*e2z)*z2*2.0+I1*dz1*(e3z*e3z)*l0+I2*dz1*(e2z*e2z)*l0+I1*dz2*(e3z*e3z)*l0+I2*dz2*(e2z*e2z)*l0+I2*e2x*e2z*x1*2.0+I1*e3x*e3z*x1*2.0-I2*e2x*e2z*x2*2.0-I1*e3x*e3z*x2*2.0+I2*e2y*e2z*y1*2.0+I1*e3y*e3z*y1*2.0-I2*e2y*e2z*y2*2.0-I1*e3y*e3z*y2*2.0+I2*dx1*e2x*e2z*l0+I1*dx1*e3x*e3z*l0+I2*dx2*e2x*e2z*l0+I1*dx2*e3x*e3z*l0+I2*dy1*e2y*e2z*l0+I1*dy1*e3y*e3z*l0+I2*dy2*e2y*e2z*l0+I1*dy2*e3y*e3z*l0)*-6.0;
    hcu_q(3) = -1.0/(l0*l0)*(E*I1*(e3x*e3x)*x1*6.0+E*I2*(e2x*e2x)*x1*6.0-E*I1*(e3x*e3x)*x2*6.0-E*I2*(e2x*e2x)*x2*6.0+G*I0*(e3y*e3y)*x1*6.0-G*I0*(e3y*e3y)*x2*6.0+E*I2*e2x*e2y*y1*6.0+E*I1*e3x*e3y*y1*6.0-E*I2*e2x*e2y*y2*6.0-E*I1*e3x*e3y*y2*6.0+E*I2*e2x*e2z*z1*6.0+E*I1*e3x*e3z*z1*6.0-E*I2*e2x*e2z*z2*6.0-E*I1*e3x*e3z*z2*6.0-G*I0*e3x*e3y*y1*6.0+G*I0*e3x*e3y*y2*6.0+E*I1*dx1*(e3x*e3x)*l0*4.0+E*I2*dx1*(e2x*e2x)*l0*4.0+E*I1*dx2*(e3x*e3x)*l0*2.0+E*I2*dx2*(e2x*e2x)*l0*2.0+G*I0*dx1*(e3y*e3y)*l0*4.0+G*I0*dx2*(e3y*e3y)*l0*2.0-E*I1*e3x*wss01*(l0*l0)+E*I2*e2x*wss02*(l0*l0)+E*I2*dy1*e2x*e2y*l0*4.0+E*I1*dy1*e3x*e3y*l0*4.0+E*I2*dy2*e2x*e2y*l0*2.0+E*I1*dy2*e3x*e3y*l0*2.0+E*I2*dz1*e2x*e2z*l0*4.0+E*I1*dz1*e3x*e3z*l0*4.0+E*I2*dz2*e2x*e2z*l0*2.0+E*I1*dz2*e3x*e3z*l0*2.0-G*I0*dy1*e3x*e3y*l0*4.0-G*I0*dy2*e3x*e3y*l0*2.0);
    hcu_q(4) = -1.0/(l0*l0)*(E*I1*(e3y*e3y)*y1*6.0+E*I2*(e2y*e2y)*y1*6.0-E*I1*(e3y*e3y)*y2*6.0-E*I2*(e2y*e2y)*y2*6.0+G*I0*(e3x*e3x)*y1*6.0-G*I0*(e3x*e3x)*y2*6.0+E*I2*e2x*e2y*x1*6.0+E*I1*e3x*e3y*x1*6.0-E*I2*e2x*e2y*x2*6.0-E*I1*e3x*e3y*x2*6.0-G*I0*e3x*e3y*x1*6.0+G*I0*e3x*e3y*x2*6.0+E*I2*e2y*e2z*z1*6.0+E*I1*e3y*e3z*z1*6.0-E*I2*e2y*e2z*z2*6.0-E*I1*e3y*e3z*z2*6.0+E*I1*dy1*(e3y*e3y)*l0*4.0+E*I2*dy1*(e2y*e2y)*l0*4.0+E*I1*dy2*(e3y*e3y)*l0*2.0+E*I2*dy2*(e2y*e2y)*l0*2.0+G*I0*dy1*(e3x*e3x)*l0*4.0+G*I0*dy2*(e3x*e3x)*l0*2.0-E*I1*e3y*wss01*(l0*l0)+E*I2*e2y*wss02*(l0*l0)+E*I2*dx1*e2x*e2y*l0*4.0+E*I1*dx1*e3x*e3y*l0*4.0+E*I2*dx2*e2x*e2y*l0*2.0+E*I1*dx2*e3x*e3y*l0*2.0+E*I2*dz1*e2y*e2z*l0*4.0+E*I1*dz1*e3y*e3z*l0*4.0+E*I2*dz2*e2y*e2z*l0*2.0+E*I1*dz2*e3y*e3z*l0*2.0-G*I0*dx1*e3x*e3y*l0*4.0-G*I0*dx2*e3x*e3y*l0*2.0);
    hcu_q(5) = -E*1.0/(l0*l0)*(I1*(e3z*e3z)*z1*6.0+I2*(e2z*e2z)*z1*6.0-I1*(e3z*e3z)*z2*6.0-I2*(e2z*e2z)*z2*6.0+I1*dz1*(e3z*e3z)*l0*4.0+I2*dz1*(e2z*e2z)*l0*4.0+I1*dz2*(e3z*e3z)*l0*2.0+I2*dz2*(e2z*e2z)*l0*2.0-I1*e3z*wss01*(l0*l0)+I2*e2z*wss02*(l0*l0)+I2*e2x*e2z*x1*6.0+I1*e3x*e3z*x1*6.0-I2*e2x*e2z*x2*6.0-I1*e3x*e3z*x2*6.0+I2*e2y*e2z*y1*6.0+I1*e3y*e3z*y1*6.0-I2*e2y*e2z*y2*6.0-I1*e3y*e3z*y2*6.0+I2*dx1*e2x*e2z*l0*4.0+I1*dx1*e3x*e3z*l0*4.0+I2*dx2*e2x*e2z*l0*2.0+I1*dx2*e3x*e3z*l0*2.0+I2*dy1*e2y*e2z*l0*4.0+I1*dy1*e3y*e3z*l0*4.0+I2*dy2*e2y*e2z*l0*2.0+I1*dy2*e3y*e3z*l0*2.0);
    hcu_q(6) = 1.0/(l0*l0*l0)*(E*I1*(e3x*e3x)*x1*2.0+E*I2*(e2x*e2x)*x1*2.0-E*I1*(e3x*e3x)*x2*2.0-E*I2*(e2x*e2x)*x2*2.0+G*I0*(e3y*e3y)*x1*2.0-G*I0*(e3y*e3y)*x2*2.0+E*I2*e2x*e2y*y1*2.0+E*I1*e3x*e3y*y1*2.0-E*I2*e2x*e2y*y2*2.0-E*I1*e3x*e3y*y2*2.0+E*I2*e2x*e2z*z1*2.0+E*I1*e3x*e3z*z1*2.0-E*I2*e2x*e2z*z2*2.0-E*I1*e3x*e3z*z2*2.0-G*I0*e3x*e3y*y1*2.0+G*I0*e3x*e3y*y2*2.0+E*I1*dx1*(e3x*e3x)*l0+E*I2*dx1*(e2x*e2x)*l0+E*I1*dx2*(e3x*e3x)*l0+E*I2*dx2*(e2x*e2x)*l0+G*I0*dx1*(e3y*e3y)*l0+G*I0*dx2*(e3y*e3y)*l0+E*I2*dy1*e2x*e2y*l0+E*I1*dy1*e3x*e3y*l0+E*I2*dy2*e2x*e2y*l0+E*I1*dy2*e3x*e3y*l0+E*I2*dz1*e2x*e2z*l0+E*I1*dz1*e3x*e3z*l0+E*I2*dz2*e2x*e2z*l0+E*I1*dz2*e3x*e3z*l0-G*I0*dy1*e3x*e3y*l0-G*I0*dy2*e3x*e3y*l0)*6.0;
    hcu_q(7) = 1.0/(l0*l0*l0)*(E*I1*(e3y*e3y)*y1*2.0+E*I2*(e2y*e2y)*y1*2.0-E*I1*(e3y*e3y)*y2*2.0-E*I2*(e2y*e2y)*y2*2.0+G*I0*(e3x*e3x)*y1*2.0-G*I0*(e3x*e3x)*y2*2.0+E*I2*e2x*e2y*x1*2.0+E*I1*e3x*e3y*x1*2.0-E*I2*e2x*e2y*x2*2.0-E*I1*e3x*e3y*x2*2.0-G*I0*e3x*e3y*x1*2.0+G*I0*e3x*e3y*x2*2.0+E*I2*e2y*e2z*z1*2.0+E*I1*e3y*e3z*z1*2.0-E*I2*e2y*e2z*z2*2.0-E*I1*e3y*e3z*z2*2.0+E*I1*dy1*(e3y*e3y)*l0+E*I2*dy1*(e2y*e2y)*l0+E*I1*dy2*(e3y*e3y)*l0+E*I2*dy2*(e2y*e2y)*l0+G*I0*dy1*(e3x*e3x)*l0+G*I0*dy2*(e3x*e3x)*l0+E*I2*dx1*e2x*e2y*l0+E*I1*dx1*e3x*e3y*l0+E*I2*dx2*e2x*e2y*l0+E*I1*dx2*e3x*e3y*l0+E*I2*dz1*e2y*e2z*l0+E*I1*dz1*e3y*e3z*l0+E*I2*dz2*e2y*e2z*l0+E*I1*dz2*e3y*e3z*l0-G*I0*dx1*e3x*e3y*l0-G*I0*dx2*e3x*e3y*l0)*6.0;
    hcu_q(8) = E*1.0/(l0*l0*l0)*(I1*(e3z*e3z)*z1*2.0+I2*(e2z*e2z)*z1*2.0-I1*(e3z*e3z)*z2*2.0-I2*(e2z*e2z)*z2*2.0+I1*dz1*(e3z*e3z)*l0+I2*dz1*(e2z*e2z)*l0+I1*dz2*(e3z*e3z)*l0+I2*dz2*(e2z*e2z)*l0+I2*e2x*e2z*x1*2.0+I1*e3x*e3z*x1*2.0-I2*e2x*e2z*x2*2.0-I1*e3x*e3z*x2*2.0+I2*e2y*e2z*y1*2.0+I1*e3y*e3z*y1*2.0-I2*e2y*e2z*y2*2.0-I1*e3y*e3z*y2*2.0+I2*dx1*e2x*e2z*l0+I1*dx1*e3x*e3z*l0+I2*dx2*e2x*e2z*l0+I1*dx2*e3x*e3z*l0+I2*dy1*e2y*e2z*l0+I1*dy1*e3y*e3z*l0+I2*dy2*e2y*e2z*l0+I1*dy2*e3y*e3z*l0)*6.0;
    hcu_q(9) = -1.0/(l0*l0)*(E*I1*(e3x*e3x)*x1*6.0+E*I2*(e2x*e2x)*x1*6.0-E*I1*(e3x*e3x)*x2*6.0-E*I2*(e2x*e2x)*x2*6.0+G*I0*(e3y*e3y)*x1*6.0-G*I0*(e3y*e3y)*x2*6.0+E*I2*e2x*e2y*y1*6.0+E*I1*e3x*e3y*y1*6.0-E*I2*e2x*e2y*y2*6.0-E*I1*e3x*e3y*y2*6.0+E*I2*e2x*e2z*z1*6.0+E*I1*e3x*e3z*z1*6.0-E*I2*e2x*e2z*z2*6.0-E*I1*e3x*e3z*z2*6.0-G*I0*e3x*e3y*y1*6.0+G*I0*e3x*e3y*y2*6.0+E*I1*dx1*(e3x*e3x)*l0*2.0+E*I2*dx1*(e2x*e2x)*l0*2.0+E*I1*dx2*(e3x*e3x)*l0*4.0+E*I2*dx2*(e2x*e2x)*l0*4.0+G*I0*dx1*(e3y*e3y)*l0*2.0+G*I0*dx2*(e3y*e3y)*l0*4.0+E*I1*e3x*wss01*(l0*l0)-E*I2*e2x*wss02*(l0*l0)+E*I2*dy1*e2x*e2y*l0*2.0+E*I1*dy1*e3x*e3y*l0*2.0+E*I2*dy2*e2x*e2y*l0*4.0+E*I1*dy2*e3x*e3y*l0*4.0+E*I2*dz1*e2x*e2z*l0*2.0+E*I1*dz1*e3x*e3z*l0*2.0+E*I2*dz2*e2x*e2z*l0*4.0+E*I1*dz2*e3x*e3z*l0*4.0-G*I0*dy1*e3x*e3y*l0*2.0-G*I0*dy2*e3x*e3y*l0*4.0);
    hcu_q(10) = -1.0/(l0*l0)*(E*I1*(e3y*e3y)*y1*6.0+E*I2*(e2y*e2y)*y1*6.0-E*I1*(e3y*e3y)*y2*6.0-E*I2*(e2y*e2y)*y2*6.0+G*I0*(e3x*e3x)*y1*6.0-G*I0*(e3x*e3x)*y2*6.0+E*I2*e2x*e2y*x1*6.0+E*I1*e3x*e3y*x1*6.0-E*I2*e2x*e2y*x2*6.0-E*I1*e3x*e3y*x2*6.0-G*I0*e3x*e3y*x1*6.0+G*I0*e3x*e3y*x2*6.0+E*I2*e2y*e2z*z1*6.0+E*I1*e3y*e3z*z1*6.0-E*I2*e2y*e2z*z2*6.0-E*I1*e3y*e3z*z2*6.0+E*I1*dy1*(e3y*e3y)*l0*2.0+E*I2*dy1*(e2y*e2y)*l0*2.0+E*I1*dy2*(e3y*e3y)*l0*4.0+E*I2*dy2*(e2y*e2y)*l0*4.0+G*I0*dy1*(e3x*e3x)*l0*2.0+G*I0*dy2*(e3x*e3x)*l0*4.0+E*I1*e3y*wss01*(l0*l0)-E*I2*e2y*wss02*(l0*l0)+E*I2*dx1*e2x*e2y*l0*2.0+E*I1*dx1*e3x*e3y*l0*2.0+E*I2*dx2*e2x*e2y*l0*4.0+E*I1*dx2*e3x*e3y*l0*4.0+E*I2*dz1*e2y*e2z*l0*2.0+E*I1*dz1*e3y*e3z*l0*2.0+E*I2*dz2*e2y*e2z*l0*4.0+E*I1*dz2*e3y*e3z*l0*4.0-G*I0*dx1*e3x*e3y*l0*2.0-G*I0*dx2*e3x*e3y*l0*4.0);
    hcu_q(11) = -E*1.0/(l0*l0)*(I1*(e3z*e3z)*z1*6.0+I2*(e2z*e2z)*z1*6.0-I1*(e3z*e3z)*z2*6.0-I2*(e2z*e2z)*z2*6.0+I1*dz1*(e3z*e3z)*l0*2.0+I2*dz1*(e2z*e2z)*l0*2.0+I1*dz2*(e3z*e3z)*l0*4.0+I2*dz2*(e2z*e2z)*l0*4.0+I1*e3z*wss01*(l0*l0)-I2*e2z*wss02*(l0*l0)+I2*e2x*e2z*x1*6.0+I1*e3x*e3z*x1*6.0-I2*e2x*e2z*x2*6.0-I1*e3x*e3z*x2*6.0+I2*e2y*e2z*y1*6.0+I1*e3y*e3z*y1*6.0-I2*e2y*e2z*y2*6.0-I1*e3y*e3z*y2*6.0+I2*dx1*e2x*e2z*l0*2.0+I1*dx1*e3x*e3z*l0*2.0+I2*dx2*e2x*e2z*l0*4.0+I1*dx2*e3x*e3z*l0*4.0+I2*dy1*e2y*e2z*l0*2.0+I1*dy1*e3y*e3z*l0*2.0+I2*dy2*e2y*e2z*l0*4.0+I1*dy2*e3y*e3z*l0*4.0);
    
    Vec hcu_e2(3,NONINIT);
    hcu_e2(0) = (l0*l0)*(E*I2*1.0/(l0*l0*l0*l0*l0)*(x1*2.0-x2*2.0+dx1*l0+dx2*l0)*(e2x*x1*6.0-e2x*x2*6.0+e2y*y1*6.0-e2y*y2*6.0+e2z*z1*6.0-e2z*z2*6.0+wss02*(l0*l0)+dx1*e2x*l0*4.0+dx2*e2x*l0*2.0+dy1*e2y*l0*4.0+dy2*e2y*l0*2.0+dz1*e2z*l0*4.0+dz2*e2z*l0*2.0)*3.0-E*I2*1.0/(l0*l0*l0*l0*l0)*(x1*2.0-x2*2.0+dx1*l0+dx2*l0)*(e2x*x1*2.0-e2x*x2*2.0+e2y*y1*2.0-e2y*y2*2.0+e2z*z1*2.0-e2z*z2*2.0+dx1*e2x*l0+dx2*e2x*l0+dy1*e2y*l0+dy2*e2y*l0+dz1*e2z*l0+dz2*e2z*l0)*1.2E1+E*I2*1.0/(l0*l0*l0*l0*l0)*(x1*6.0-x2*6.0+dx1*l0*4.0+dx2*l0*2.0)*(e2x*x1*2.0-e2x*x2*2.0+e2y*y1*2.0-e2y*y2*2.0+e2z*z1*2.0-e2z*z2*2.0+dx1*e2x*l0+dx2*e2x*l0+dy1*e2y*l0+dy2*e2y*l0+dz1*e2z*l0+dz2*e2z*l0)*3.0)-E*I2*1.0/(l0*l0*l0)*(x1*6.0-x2*6.0+dx1*l0*4.0+dx2*l0*2.0)*(e2x*x1*6.0-e2x*x2*6.0+e2y*y1*6.0-e2y*y2*6.0+e2z*z1*6.0-e2z*z2*6.0+wss02*(l0*l0)+dx1*e2x*l0*4.0+dx2*e2x*l0*2.0+dy1*e2y*l0*4.0+dy2*e2y*l0*2.0+dz1*e2z*l0*4.0+dz2*e2z*l0*2.0);
    hcu_e2(1) = (l0*l0)*(E*I2*1.0/(l0*l0*l0*l0*l0)*(y1*2.0-y2*2.0+dy1*l0+dy2*l0)*(e2x*x1*6.0-e2x*x2*6.0+e2y*y1*6.0-e2y*y2*6.0+e2z*z1*6.0-e2z*z2*6.0+wss02*(l0*l0)+dx1*e2x*l0*4.0+dx2*e2x*l0*2.0+dy1*e2y*l0*4.0+dy2*e2y*l0*2.0+dz1*e2z*l0*4.0+dz2*e2z*l0*2.0)*3.0-E*I2*1.0/(l0*l0*l0*l0*l0)*(y1*2.0-y2*2.0+dy1*l0+dy2*l0)*(e2x*x1*2.0-e2x*x2*2.0+e2y*y1*2.0-e2y*y2*2.0+e2z*z1*2.0-e2z*z2*2.0+dx1*e2x*l0+dx2*e2x*l0+dy1*e2y*l0+dy2*e2y*l0+dz1*e2z*l0+dz2*e2z*l0)*1.2E1+E*I2*1.0/(l0*l0*l0*l0*l0)*(y1*6.0-y2*6.0+dy1*l0*4.0+dy2*l0*2.0)*(e2x*x1*2.0-e2x*x2*2.0+e2y*y1*2.0-e2y*y2*2.0+e2z*z1*2.0-e2z*z2*2.0+dx1*e2x*l0+dx2*e2x*l0+dy1*e2y*l0+dy2*e2y*l0+dz1*e2z*l0+dz2*e2z*l0)*3.0)-E*I2*1.0/(l0*l0*l0)*(y1*6.0-y2*6.0+dy1*l0*4.0+dy2*l0*2.0)*(e2x*x1*6.0-e2x*x2*6.0+e2y*y1*6.0-e2y*y2*6.0+e2z*z1*6.0-e2z*z2*6.0+wss02*(l0*l0)+dx1*e2x*l0*4.0+dx2*e2x*l0*2.0+dy1*e2y*l0*4.0+dy2*e2y*l0*2.0+dz1*e2z*l0*4.0+dz2*e2z*l0*2.0);
    hcu_e2(2) = (l0*l0)*(E*I2*1.0/(l0*l0*l0*l0*l0)*(z1*2.0-z2*2.0+dz1*l0+dz2*l0)*(e2x*x1*6.0-e2x*x2*6.0+e2y*y1*6.0-e2y*y2*6.0+e2z*z1*6.0-e2z*z2*6.0+wss02*(l0*l0)+dx1*e2x*l0*4.0+dx2*e2x*l0*2.0+dy1*e2y*l0*4.0+dy2*e2y*l0*2.0+dz1*e2z*l0*4.0+dz2*e2z*l0*2.0)*3.0-E*I2*1.0/(l0*l0*l0*l0*l0)*(z1*2.0-z2*2.0+dz1*l0+dz2*l0)*(e2x*x1*2.0-e2x*x2*2.0+e2y*y1*2.0-e2y*y2*2.0+e2z*z1*2.0-e2z*z2*2.0+dx1*e2x*l0+dx2*e2x*l0+dy1*e2y*l0+dy2*e2y*l0+dz1*e2z*l0+dz2*e2z*l0)*1.2E1+E*I2*1.0/(l0*l0*l0*l0*l0)*(z1*6.0-z2*6.0+dz1*l0*4.0+dz2*l0*2.0)*(e2x*x1*2.0-e2x*x2*2.0+e2y*y1*2.0-e2y*y2*2.0+e2z*z1*2.0-e2z*z2*2.0+dx1*e2x*l0+dx2*e2x*l0+dy1*e2y*l0+dy2*e2y*l0+dz1*e2z*l0+dz2*e2z*l0)*3.0)-E*I2*1.0/(l0*l0*l0)*(z1*6.0-z2*6.0+dz1*l0*4.0+dz2*l0*2.0)*(e2x*x1*6.0-e2x*x2*6.0+e2y*y1*6.0-e2y*y2*6.0+e2z*z1*6.0-e2z*z2*6.0+wss02*(l0*l0)+dx1*e2x*l0*4.0+dx2*e2x*l0*2.0+dy1*e2y*l0*4.0+dy2*e2y*l0*2.0+dz1*e2z*l0*4.0+dz2*e2z*l0*2.0);
    
    Vec hcu_e3(3,NONINIT);
    hcu_e3(0) = -(l0*l0)*(l0*(E*I1*1.0/(l0*l0*l0*l0*l0*l0)*(x1*2.0-x2*2.0+dx1*l0+dx2*l0)*(e3x*x1*2.0-e3x*x2*2.0+e3y*y1*2.0-e3y*y2*2.0+e3z*z1*2.0-e3z*z2*2.0+dx1*e3x*l0+dx2*e3x*l0+dy1*e3y*l0+dy2*e3y*l0+dz1*e3z*l0+dz2*e3z*l0)*1.2E1-G*I0*1.0/(l0*l0*l0*l0*l0*l0)*(y1*2.0-y2*2.0+dy1*l0+dy2*l0)*(e3y*x1*2.0-e3y*x2*2.0-e3x*y1*2.0+e3x*y2*2.0+dx1*e3y*l0+dx2*e3y*l0-dy1*e3x*l0-dy2*e3x*l0)*1.2E1)-E*I1*1.0/(l0*l0*l0*l0*l0)*(x1*2.0-x2*2.0+dx1*l0+dx2*l0)*(e3x*x1*6.0-e3x*x2*6.0+e3y*y1*6.0-e3y*y2*6.0+e3z*z1*6.0-e3z*z2*6.0-wss01*(l0*l0)+dx1*e3x*l0*4.0+dx2*e3x*l0*2.0+dy1*e3y*l0*4.0+dy2*e3y*l0*2.0+dz1*e3z*l0*4.0+dz2*e3z*l0*2.0)*3.0-E*I1*1.0/(l0*l0*l0*l0*l0)*(x1*6.0-x2*6.0+dx1*l0*4.0+dx2*l0*2.0)*(e3x*x1*2.0-e3x*x2*2.0+e3y*y1*2.0-e3y*y2*2.0+e3z*z1*2.0-e3z*z2*2.0+dx1*e3x*l0+dx2*e3x*l0+dy1*e3y*l0+dy2*e3y*l0+dz1*e3z*l0+dz2*e3z*l0)*3.0+G*I0*1.0/(l0*l0*l0*l0*l0)*(y1*3.0-y2*3.0+dy1*l0*2.0+dy2*l0)*(e3y*x1*2.0-e3y*x2*2.0-e3x*y1*2.0+e3x*y2*2.0+dx1*e3y*l0+dx2*e3y*l0-dy1*e3x*l0-dy2*e3x*l0)*6.0+G*I0*1.0/(l0*l0*l0*l0*l0)*(y1*2.0-y2*2.0+dy1*l0+dy2*l0)*(e3y*x1*3.0-e3y*x2*3.0-e3x*y1*3.0+e3x*y2*3.0+dx1*e3y*l0*2.0+dx2*e3y*l0-dy1*e3x*l0*2.0-dy2*e3x*l0)*6.0)-E*I1*1.0/(l0*l0*l0)*(x1*6.0-x2*6.0+dx1*l0*4.0+dx2*l0*2.0)*(e3x*x1*6.0-e3x*x2*6.0+e3y*y1*6.0-e3y*y2*6.0+e3z*z1*6.0-e3z*z2*6.0-wss01*(l0*l0)+dx1*e3x*l0*4.0+dx2*e3x*l0*2.0+dy1*e3y*l0*4.0+dy2*e3y*l0*2.0+dz1*e3z*l0*4.0+dz2*e3z*l0*2.0)+G*I0*1.0/(l0*l0*l0)*(y1*3.0-y2*3.0+dy1*l0*2.0+dy2*l0)*(e3y*x1*3.0-e3y*x2*3.0-e3x*y1*3.0+e3x*y2*3.0+dx1*e3y*l0*2.0+dx2*e3y*l0-dy1*e3x*l0*2.0-dy2*e3x*l0)*4.0;
    hcu_e3(1) = (l0*l0)*(-l0*(E*I1*1.0/(l0*l0*l0*l0*l0*l0)*(y1*2.0-y2*2.0+dy1*l0+dy2*l0)*(e3x*x1*2.0-e3x*x2*2.0+e3y*y1*2.0-e3y*y2*2.0+e3z*z1*2.0-e3z*z2*2.0+dx1*e3x*l0+dx2*e3x*l0+dy1*e3y*l0+dy2*e3y*l0+dz1*e3z*l0+dz2*e3z*l0)*1.2E1+G*I0*1.0/(l0*l0*l0*l0*l0*l0)*(x1*2.0-x2*2.0+dx1*l0+dx2*l0)*(e3y*x1*2.0-e3y*x2*2.0-e3x*y1*2.0+e3x*y2*2.0+dx1*e3y*l0+dx2*e3y*l0-dy1*e3x*l0-dy2*e3x*l0)*1.2E1)+E*I1*1.0/(l0*l0*l0*l0*l0)*(y1*2.0-y2*2.0+dy1*l0+dy2*l0)*(e3x*x1*6.0-e3x*x2*6.0+e3y*y1*6.0-e3y*y2*6.0+e3z*z1*6.0-e3z*z2*6.0-wss01*(l0*l0)+dx1*e3x*l0*4.0+dx2*e3x*l0*2.0+dy1*e3y*l0*4.0+dy2*e3y*l0*2.0+dz1*e3z*l0*4.0+dz2*e3z*l0*2.0)*3.0+E*I1*1.0/(l0*l0*l0*l0*l0)*(y1*6.0-y2*6.0+dy1*l0*4.0+dy2*l0*2.0)*(e3x*x1*2.0-e3x*x2*2.0+e3y*y1*2.0-e3y*y2*2.0+e3z*z1*2.0-e3z*z2*2.0+dx1*e3x*l0+dx2*e3x*l0+dy1*e3y*l0+dy2*e3y*l0+dz1*e3z*l0+dz2*e3z*l0)*3.0+G*I0*1.0/(l0*l0*l0*l0*l0)*(x1*3.0-x2*3.0+dx1*l0*2.0+dx2*l0)*(e3y*x1*2.0-e3y*x2*2.0-e3x*y1*2.0+e3x*y2*2.0+dx1*e3y*l0+dx2*e3y*l0-dy1*e3x*l0-dy2*e3x*l0)*6.0+G*I0*1.0/(l0*l0*l0*l0*l0)*(x1*2.0-x2*2.0+dx1*l0+dx2*l0)*(e3y*x1*3.0-e3y*x2*3.0-e3x*y1*3.0+e3x*y2*3.0+dx1*e3y*l0*2.0+dx2*e3y*l0-dy1*e3x*l0*2.0-dy2*e3x*l0)*6.0)-E*I1*1.0/(l0*l0*l0)*(y1*6.0-y2*6.0+dy1*l0*4.0+dy2*l0*2.0)*(e3x*x1*6.0-e3x*x2*6.0+e3y*y1*6.0-e3y*y2*6.0+e3z*z1*6.0-e3z*z2*6.0-wss01*(l0*l0)+dx1*e3x*l0*4.0+dx2*e3x*l0*2.0+dy1*e3y*l0*4.0+dy2*e3y*l0*2.0+dz1*e3z*l0*4.0+dz2*e3z*l0*2.0)-G*I0*1.0/(l0*l0*l0)*(x1*3.0-x2*3.0+dx1*l0*2.0+dx2*l0)*(e3y*x1*3.0-e3y*x2*3.0-e3x*y1*3.0+e3x*y2*3.0+dx1*e3y*l0*2.0+dx2*e3y*l0-dy1*e3x*l0*2.0-dy2*e3x*l0)*4.0;
    hcu_e3(2) = (l0*l0)*(E*I1*1.0/(l0*l0*l0*l0*l0)*(z1*2.0-z2*2.0+dz1*l0+dz2*l0)*(e3x*x1*6.0-e3x*x2*6.0+e3y*y1*6.0-e3y*y2*6.0+e3z*z1*6.0-e3z*z2*6.0-wss01*(l0*l0)+dx1*e3x*l0*4.0+dx2*e3x*l0*2.0+dy1*e3y*l0*4.0+dy2*e3y*l0*2.0+dz1*e3z*l0*4.0+dz2*e3z*l0*2.0)*3.0-E*I1*1.0/(l0*l0*l0*l0*l0)*(z1*2.0-z2*2.0+dz1*l0+dz2*l0)*(e3x*x1*2.0-e3x*x2*2.0+e3y*y1*2.0-e3y*y2*2.0+e3z*z1*2.0-e3z*z2*2.0+dx1*e3x*l0+dx2*e3x*l0+dy1*e3y*l0+dy2*e3y*l0+dz1*e3z*l0+dz2*e3z*l0)*1.2E1+E*I1*1.0/(l0*l0*l0*l0*l0)*(z1*6.0-z2*6.0+dz1*l0*4.0+dz2*l0*2.0)*(e3x*x1*2.0-e3x*x2*2.0+e3y*y1*2.0-e3y*y2*2.0+e3z*z1*2.0-e3z*z2*2.0+dx1*e3x*l0+dx2*e3x*l0+dy1*e3y*l0+dy2*e3y*l0+dz1*e3z*l0+dz2*e3z*l0)*3.0)-E*I1*1.0/(l0*l0*l0)*(z1*6.0-z2*6.0+dz1*l0*4.0+dz2*l0*2.0)*(e3x*x1*6.0-e3x*x2*6.0+e3y*y1*6.0-e3y*y2*6.0+e3z*z1*6.0-e3z*z2*6.0-wss01*(l0*l0)+dx1*e3x*l0*4.0+dx2*e3x*l0*2.0+dy1*e3y*l0*4.0+dy2*e3y*l0*2.0+dz1*e3z*l0*4.0+dz2*e3z*l0*2.0);

    h = hgrav + hst_q + de1dq.T()*hst_e1 + hcu_q + de2dq.T()*hcu_e2 + de3dq.T()*hcu_e3; 

    // // Daempfung------------------------------------------------------------------
    // //    hdLokal.init(0.0); beim Initialisieren
    //     hdLokal(3) = - depsilon * epsp; // eps

    //     // Impliziten Integratoren
    //     if(implicit)
    //     {
    // 	static Mat Dhz(2*8,8,fmatvec::INIT,0.0);
    // 	Dhz   = hFullJacobi(qElement,qpElement,qLokal,qpLokal,Jeg,Jegp,MLokal,hZwischen);
    // 	Dhq   = static_cast<SqrMat>(Dhz(0,0, 8-1,8-1));
    // 	Dhqp  = static_cast<SqrMat>(Dhz(8,0,2*8-1,8-1));
    // 	Dhqp += trans(Jeg)*Damp*Jeg;
    //     }

    //     cout << "qElement = " << trans(qElement);
    //     cout << "h        = " << trans(h)        << endl;
    //     throw 1;
  }

  Vec FiniteElement1s33ANCF::computePosition(const Vec& qElement, const ContourPointData& cp) {
    const double &s = cp.getLagrangeParameterPosition()(0);

    Mat S = GlobalShapeFunctions(s).T();

    Vec pos = S*qElement;

    return pos.copy();
  }

  SqrMat FiniteElement1s33ANCF::computeOrientation(const Vec& qElement, const ContourPointData& cp) {
    SqrMat rotation(3,NONINIT);

    const double & x1 = qElement(0);    const double & y1 = qElement(1);     const double & z1 = qElement(2);
    const double &dx1 = qElement(3);    const double &dy1 = qElement(4);     const double &dz1 = qElement(5);
    const double & x2 = qElement(6);    const double & y2 = qElement(7);     const double & z2 = qElement(8);
    const double &dx2 = qElement(9);    const double &dy2 = qElement(10);    const double &dz2 = qElement(11);

    const double &s = cp.getLagrangeParameterPosition()(0);

    rotation(0,0) = 1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0);
    rotation(0,1) = -1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0);
    rotation(0,2) = -1.0/(l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0);
    rotation(1,0) = 1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0);
    rotation(1,1) = 1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0);
    rotation(1,2) = -1.0/(l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0);
    rotation(2,0) = 1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0);
    rotation(2,1) = 0.;
    rotation(2,2) = 1.0/(l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*((s*s*s*s)*(x1*x1)*3.6E1+(s*s*s*s)*(x2*x2)*3.6E1+(s*s*s*s)*(y1*y1)*3.6E1+(s*s*s*s)*(y2*y2)*3.6E1+(dx1*dx1)*(l0*l0*l0*l0*l0*l0)+(dy1*dy1)*(l0*l0*l0*l0*l0*l0)-(s*s*s*s)*x1*x2*7.2E1-(s*s*s*s)*y1*y2*7.2E1-(dx1*dx1)*(l0*l0*l0*l0*l0)*s*8.0-(dy1*dy1)*(l0*l0*l0*l0*l0)*s*8.0-l0*(s*s*s)*(x1*x1)*7.2E1-l0*(s*s*s)*(x2*x2)*7.2E1-l0*(s*s*s)*(y1*y1)*7.2E1-l0*(s*s*s)*(y2*y2)*7.2E1+(dx1*dx1)*(l0*l0)*(s*s*s*s)*9.0-(dx1*dx1)*(l0*l0*l0)*(s*s*s)*2.4E1+(dx1*dx1)*(l0*l0*l0*l0)*(s*s)*2.2E1+(dx2*dx2)*(l0*l0)*(s*s*s*s)*9.0-(dx2*dx2)*(l0*l0*l0)*(s*s*s)*1.2E1+(dx2*dx2)*(l0*l0*l0*l0)*(s*s)*4.0+(dy1*dy1)*(l0*l0)*(s*s*s*s)*9.0-(dy1*dy1)*(l0*l0*l0)*(s*s*s)*2.4E1+(dy1*dy1)*(l0*l0*l0*l0)*(s*s)*2.2E1+(dy2*dy2)*(l0*l0)*(s*s*s*s)*9.0-(dy2*dy2)*(l0*l0*l0)*(s*s*s)*1.2E1+(dy2*dy2)*(l0*l0*l0*l0)*(s*s)*4.0+(l0*l0)*(s*s)*(x1*x1)*3.6E1+(l0*l0)*(s*s)*(x2*x2)*3.6E1+(l0*l0)*(s*s)*(y1*y1)*3.6E1+(l0*l0)*(s*s)*(y2*y2)*3.6E1-dx1*dx2*(l0*l0*l0*l0*l0)*s*4.0-dy1*dy2*(l0*l0*l0*l0*l0)*s*4.0+dx1*l0*(s*s*s*s)*x1*3.6E1-dx1*(l0*l0*l0*l0)*s*x1*1.2E1-dx1*l0*(s*s*s*s)*x2*3.6E1+dx1*(l0*l0*l0*l0)*s*x2*1.2E1+dx2*l0*(s*s*s*s)*x1*3.6E1-dx2*l0*(s*s*s*s)*x2*3.6E1+dy1*l0*(s*s*s*s)*y1*3.6E1-dy1*(l0*l0*l0*l0)*s*y1*1.2E1-dy1*l0*(s*s*s*s)*y2*3.6E1+dy1*(l0*l0*l0*l0)*s*y2*1.2E1+dy2*l0*(s*s*s*s)*y1*3.6E1-dy2*l0*(s*s*s*s)*y2*3.6E1+l0*(s*s*s)*x1*x2*1.44E2+l0*(s*s*s)*y1*y2*1.44E2+dx1*dx2*(l0*l0)*(s*s*s*s)*1.8E1-dx1*dx2*(l0*l0*l0)*(s*s*s)*3.6E1+dx1*dx2*(l0*l0*l0*l0)*(s*s)*2.2E1+dy1*dy2*(l0*l0)*(s*s*s*s)*1.8E1-dy1*dy2*(l0*l0*l0)*(s*s*s)*3.6E1+dy1*dy2*(l0*l0*l0*l0)*(s*s)*2.2E1-dx1*(l0*l0)*(s*s*s)*x1*8.4E1+dx1*(l0*l0*l0)*(s*s)*x1*6.0E1+dx1*(l0*l0)*(s*s*s)*x2*8.4E1-dx1*(l0*l0*l0)*(s*s)*x2*6.0E1-dx2*(l0*l0)*(s*s*s)*x1*6.0E1+dx2*(l0*l0*l0)*(s*s)*x1*2.4E1+dx2*(l0*l0)*(s*s*s)*x2*6.0E1-dx2*(l0*l0*l0)*(s*s)*x2*2.4E1-dy1*(l0*l0)*(s*s*s)*y1*8.4E1+dy1*(l0*l0*l0)*(s*s)*y1*6.0E1+dy1*(l0*l0)*(s*s*s)*y2*8.4E1-dy1*(l0*l0*l0)*(s*s)*y2*6.0E1-dy2*(l0*l0)*(s*s*s)*y1*6.0E1+dy2*(l0*l0*l0)*(s*s)*y1*2.4E1+dy2*(l0*l0)*(s*s*s)*y2*6.0E1-dy2*(l0*l0*l0)*(s*s)*y2*2.4E1-(l0*l0)*(s*s)*x1*x2*7.2E1-(l0*l0)*(s*s)*y1*y2*7.2E1);

    return rotation.copy();
  }

  Vec FiniteElement1s33ANCF::computeVelocity(const Vec& qElement, const Vec& qpElement, const ContourPointData& cp) {
    const double &s = cp.getLagrangeParameterPosition()(0);

    Mat S = GlobalShapeFunctions(s).T();

    Vec vel = S*qpElement;

    return vel.copy();
  }

  Vec FiniteElement1s33ANCF::computeAngularVelocity(const Vec& qElement, const Vec& qpElement, const ContourPointData& cp) {
    Vec ang(3,NONINIT);

    const double & x1 = qElement(0);    const double & y1 = qElement(1);     const double & z1 = qElement(2);
    const double &dx1 = qElement(3);    const double &dy1 = qElement(4);     const double &dz1 = qElement(5);
    const double & x2 = qElement(6);    const double & y2 = qElement(7);     const double & z2 = qElement(8);
    const double &dx2 = qElement(9);    const double &dy2 = qElement(10);    const double &dz2 = qElement(11);

    const double & x1p = qpElement(0);    const double & y1p = qpElement(1);     const double & z1p = qpElement(2);
    const double &dx1p = qpElement(3);    const double &dy1p = qpElement(4);     const double &dz1p = qpElement(5);
    const double & x2p = qpElement(6);    const double & y2p = qpElement(7);     const double & z2p = qpElement(8);
    const double &dx2p = qpElement(9);    const double &dy2p = qpElement(10);    const double &dz2p = qpElement(11);

    const double &s = cp.getLagrangeParameterPosition()(0);

    ang(0) = 1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*1.0/sqrt(1.0/(l0*l0*l0*l0*l0*l0)*pow(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0,2.0)+1.0/(l0*l0*l0*l0*l0*l0)*pow(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0,2.0))*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*((s*s*s*s)*x1*y1p*3.6E1-(s*s*s*s)*x1p*y1*3.6E1-(s*s*s*s)*x1*y2p*3.6E1-(s*s*s*s)*x2*y1p*3.6E1+(s*s*s*s)*x1p*y2*3.6E1+(s*s*s*s)*x2p*y1*3.6E1+(s*s*s*s)*x2*y2p*3.6E1-(s*s*s*s)*x2p*y2*3.6E1+dx1*dy1p*(l0*l0*l0*l0*l0*l0)-dx1p*dy1*(l0*l0*l0*l0*l0*l0)-dx1*dy1p*(l0*l0*l0*l0*l0)*s*8.0+dx1p*dy1*(l0*l0*l0*l0*l0)*s*8.0-dx1*dy2p*(l0*l0*l0*l0*l0)*s*2.0-dx2*dy1p*(l0*l0*l0*l0*l0)*s*2.0+dx1p*dy2*(l0*l0*l0*l0*l0)*s*2.0+dx2p*dy1*(l0*l0*l0*l0*l0)*s*2.0+dy1p*l0*(s*s*s*s)*x1*1.8E1-dy1p*(l0*l0*l0*l0)*s*x1*6.0-dy1p*l0*(s*s*s*s)*x2*1.8E1+dy1p*(l0*l0*l0*l0)*s*x2*6.0+dy2p*l0*(s*s*s*s)*x1*1.8E1-dy2p*l0*(s*s*s*s)*x2*1.8E1-dy1*l0*(s*s*s*s)*x1p*1.8E1+dy1*(l0*l0*l0*l0)*s*x1p*6.0+dy1*l0*(s*s*s*s)*x2p*1.8E1-dy1*(l0*l0*l0*l0)*s*x2p*6.0-dy2*l0*(s*s*s*s)*x1p*1.8E1+dy2*l0*(s*s*s*s)*x2p*1.8E1-dx1p*l0*(s*s*s*s)*y1*1.8E1+dx1p*(l0*l0*l0*l0)*s*y1*6.0+dx1p*l0*(s*s*s*s)*y2*1.8E1-dx1p*(l0*l0*l0*l0)*s*y2*6.0-dx2p*l0*(s*s*s*s)*y1*1.8E1+dx2p*l0*(s*s*s*s)*y2*1.8E1+dx1*l0*(s*s*s*s)*y1p*1.8E1-dx1*(l0*l0*l0*l0)*s*y1p*6.0-dx1*l0*(s*s*s*s)*y2p*1.8E1+dx1*(l0*l0*l0*l0)*s*y2p*6.0+dx2*l0*(s*s*s*s)*y1p*1.8E1-dx2*l0*(s*s*s*s)*y2p*1.8E1-l0*(s*s*s)*x1*y1p*7.2E1+l0*(s*s*s)*x1p*y1*7.2E1+l0*(s*s*s)*x1*y2p*7.2E1+l0*(s*s*s)*x2*y1p*7.2E1-l0*(s*s*s)*x1p*y2*7.2E1-l0*(s*s*s)*x2p*y1*7.2E1-l0*(s*s*s)*x2*y2p*7.2E1+l0*(s*s*s)*x2p*y2*7.2E1+dx1*dy1p*(l0*l0)*(s*s*s*s)*9.0-dx1*dy1p*(l0*l0*l0)*(s*s*s)*2.4E1+dx1*dy1p*(l0*l0*l0*l0)*(s*s)*2.2E1-dx1p*dy1*(l0*l0)*(s*s*s*s)*9.0+dx1p*dy1*(l0*l0*l0)*(s*s*s)*2.4E1-dx1p*dy1*(l0*l0*l0*l0)*(s*s)*2.2E1+dx1*dy2p*(l0*l0)*(s*s*s*s)*9.0-dx1*dy2p*(l0*l0*l0)*(s*s*s)*1.8E1+dx1*dy2p*(l0*l0*l0*l0)*(s*s)*1.1E1+dx2*dy1p*(l0*l0)*(s*s*s*s)*9.0-dx2*dy1p*(l0*l0*l0)*(s*s*s)*1.8E1+dx2*dy1p*(l0*l0*l0*l0)*(s*s)*1.1E1-dx1p*dy2*(l0*l0)*(s*s*s*s)*9.0+dx1p*dy2*(l0*l0*l0)*(s*s*s)*1.8E1-dx1p*dy2*(l0*l0*l0*l0)*(s*s)*1.1E1-dx2p*dy1*(l0*l0)*(s*s*s*s)*9.0+dx2p*dy1*(l0*l0*l0)*(s*s*s)*1.8E1-dx2p*dy1*(l0*l0*l0*l0)*(s*s)*1.1E1+dx2*dy2p*(l0*l0)*(s*s*s*s)*9.0-dx2*dy2p*(l0*l0*l0)*(s*s*s)*1.2E1+dx2*dy2p*(l0*l0*l0*l0)*(s*s)*4.0-dx2p*dy2*(l0*l0)*(s*s*s*s)*9.0+dx2p*dy2*(l0*l0*l0)*(s*s*s)*1.2E1-dx2p*dy2*(l0*l0*l0*l0)*(s*s)*4.0-dy1p*(l0*l0)*(s*s*s)*x1*4.2E1+dy1p*(l0*l0*l0)*(s*s)*x1*3.0E1+dy1p*(l0*l0)*(s*s*s)*x2*4.2E1-dy1p*(l0*l0*l0)*(s*s)*x2*3.0E1-dy2p*(l0*l0)*(s*s*s)*x1*3.0E1+dy2p*(l0*l0*l0)*(s*s)*x1*1.2E1+dy2p*(l0*l0)*(s*s*s)*x2*3.0E1-dy2p*(l0*l0*l0)*(s*s)*x2*1.2E1+dy1*(l0*l0)*(s*s*s)*x1p*4.2E1-dy1*(l0*l0*l0)*(s*s)*x1p*3.0E1-dy1*(l0*l0)*(s*s*s)*x2p*4.2E1+dy1*(l0*l0*l0)*(s*s)*x2p*3.0E1+dy2*(l0*l0)*(s*s*s)*x1p*3.0E1-dy2*(l0*l0*l0)*(s*s)*x1p*1.2E1-dy2*(l0*l0)*(s*s*s)*x2p*3.0E1+dy2*(l0*l0*l0)*(s*s)*x2p*1.2E1+dx1p*(l0*l0)*(s*s*s)*y1*4.2E1-dx1p*(l0*l0*l0)*(s*s)*y1*3.0E1-dx1p*(l0*l0)*(s*s*s)*y2*4.2E1+dx1p*(l0*l0*l0)*(s*s)*y2*3.0E1+dx2p*(l0*l0)*(s*s*s)*y1*3.0E1-dx2p*(l0*l0*l0)*(s*s)*y1*1.2E1-dx2p*(l0*l0)*(s*s*s)*y2*3.0E1+dx2p*(l0*l0*l0)*(s*s)*y2*1.2E1-dx1*(l0*l0)*(s*s*s)*y1p*4.2E1+dx1*(l0*l0*l0)*(s*s)*y1p*3.0E1+dx1*(l0*l0)*(s*s*s)*y2p*4.2E1-dx1*(l0*l0*l0)*(s*s)*y2p*3.0E1-dx2*(l0*l0)*(s*s*s)*y1p*3.0E1+dx2*(l0*l0*l0)*(s*s)*y1p*1.2E1+dx2*(l0*l0)*(s*s*s)*y2p*3.0E1-dx2*(l0*l0*l0)*(s*s)*y2p*1.2E1+(l0*l0)*(s*s)*x1*y1p*3.6E1-(l0*l0)*(s*s)*x1p*y1*3.6E1-(l0*l0)*(s*s)*x1*y2p*3.6E1-(l0*l0)*(s*s)*x2*y1p*3.6E1+(l0*l0)*(s*s)*x1p*y2*3.6E1+(l0*l0)*(s*s)*x2p*y1*3.6E1+(l0*l0)*(s*s)*x2*y2p*3.6E1-(l0*l0)*(s*s)*x2p*y2*3.6E1);
    ang(1) = 1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*((1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(1.0/(l0*l0*l0)*((1.0/(l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*pow(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0,2.0))/(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))-1.0)*(dz1p*(l0*l0*l0)+(s*s)*z1p*6.0-(s*s)*z2p*6.0+dz1p*l0*(s*s)*3.0-dz1p*(l0*l0)*s*4.0+dz2p*l0*(s*s)*3.0-dz2p*(l0*l0)*s*2.0-l0*s*z1p*6.0+l0*s*z2p*6.0)+(1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*(dx1p*(l0*l0*l0)+(s*s)*x1p*6.0-(s*s)*x2p*6.0+dx1p*l0*(s*s)*3.0-dx1p*(l0*l0)*s*4.0+dx2p*l0*(s*s)*3.0-dx2p*(l0*l0)*s*2.0-l0*s*x1p*6.0+l0*s*x2p*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0))/(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))+(1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*(dy1p*(l0*l0*l0)+(s*s)*y1p*6.0-(s*s)*y2p*6.0+dy1p*l0*(s*s)*3.0-dy1p*(l0*l0)*s*4.0+dy2p*l0*(s*s)*3.0-dy2p*(l0*l0)*s*2.0-l0*s*y1p*6.0+l0*s*y2p*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0))/(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0)))*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0))/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)))+1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*(1.0/(l0*l0*l0)*((1.0/(l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*pow(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0,2.0))/(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))-1.0)*(dx1p*(l0*l0*l0)+(s*s)*x1p*6.0-(s*s)*x2p*6.0+dx1p*l0*(s*s)*3.0-dx1p*(l0*l0)*s*4.0+dx2p*l0*(s*s)*3.0-dx2p*(l0*l0)*s*2.0-l0*s*x1p*6.0+l0*s*x2p*6.0)+(1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*(dy1p*(l0*l0*l0)+(s*s)*y1p*6.0-(s*s)*y2p*6.0+dy1p*l0*(s*s)*3.0-dy1p*(l0*l0)*s*4.0+dy2p*l0*(s*s)*3.0-dy2p*(l0*l0)*s*2.0-l0*s*y1p*6.0+l0*s*y2p*6.0))/(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)))*1.0/sqrt(1.0/(l0*l0*l0*l0*l0*l0)*pow(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0,2.0)+1.0/(l0*l0*l0*l0*l0*l0)*pow(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0,2.0))*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0))*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)-1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*((1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(1.0/(l0*l0*l0)*((1.0/(l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*pow(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0,2.0))/(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))-1.0)*(dx1p*(l0*l0*l0)+(s*s)*x1p*6.0-(s*s)*x2p*6.0+dx1p*l0*(s*s)*3.0-dx1p*(l0*l0)*s*4.0+dx2p*l0*(s*s)*3.0-dx2p*(l0*l0)*s*2.0-l0*s*x1p*6.0+l0*s*x2p*6.0)+(1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*(dy1p*(l0*l0*l0)+(s*s)*y1p*6.0-(s*s)*y2p*6.0+dy1p*l0*(s*s)*3.0-dy1p*(l0*l0)*s*4.0+dy2p*l0*(s*s)*3.0-dy2p*(l0*l0)*s*2.0-l0*s*y1p*6.0+l0*s*y2p*6.0))/(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))+(1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*(dz1p*(l0*l0*l0)+(s*s)*z1p*6.0-(s*s)*z2p*6.0+dz1p*l0*(s*s)*3.0-dz1p*(l0*l0)*s*4.0+dz2p*l0*(s*s)*3.0-dz2p*(l0*l0)*s*2.0-l0*s*z1p*6.0+l0*s*z2p*6.0))/(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0)))*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0))/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)))+(1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(1.0/(l0*l0*l0)*((1.0/(l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*pow(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0,2.0))/(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))-1.0)*(dy1p*(l0*l0*l0)+(s*s)*y1p*6.0-(s*s)*y2p*6.0+dy1p*l0*(s*s)*3.0-dy1p*(l0*l0)*s*4.0+dy2p*l0*(s*s)*3.0-dy2p*(l0*l0)*s*2.0-l0*s*y1p*6.0+l0*s*y2p*6.0)+(1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*(dx1p*(l0*l0*l0)+(s*s)*x1p*6.0-(s*s)*x2p*6.0+dx1p*l0*(s*s)*3.0-dx1p*(l0*l0)*s*4.0+dx2p*l0*(s*s)*3.0-dx2p*(l0*l0)*s*2.0-l0*s*x1p*6.0+l0*s*x2p*6.0)*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0))/(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))+(1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*(dz1p*(l0*l0*l0)+(s*s)*z1p*6.0-(s*s)*z2p*6.0+dz1p*l0*(s*s)*3.0-dz1p*(l0*l0)*s*4.0+dz2p*l0*(s*s)*3.0-dz2p*(l0*l0)*s*2.0-l0*s*z1p*6.0+l0*s*z2p*6.0))/(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0)))*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0))/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)))+1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*(1.0/(l0*l0*l0)*((1.0/(l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*pow(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0,2.0))/(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))-1.0)*(dx1p*(l0*l0*l0)+(s*s)*x1p*6.0-(s*s)*x2p*6.0+dx1p*l0*(s*s)*3.0-dx1p*(l0*l0)*s*4.0+dx2p*l0*(s*s)*3.0-dx2p*(l0*l0)*s*2.0-l0*s*x1p*6.0+l0*s*x2p*6.0)+(1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*(dy1p*(l0*l0*l0)+(s*s)*y1p*6.0-(s*s)*y2p*6.0+dy1p*l0*(s*s)*3.0-dy1p*(l0*l0)*s*4.0+dy2p*l0*(s*s)*3.0-dy2p*(l0*l0)*s*2.0-l0*s*y1p*6.0+l0*s*y2p*6.0))/(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)))*1.0/sqrt(1.0/(l0*l0*l0*l0*l0*l0)*pow(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0,2.0)+1.0/(l0*l0*l0*l0*l0*l0)*pow(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0,2.0))*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)+1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*(1.0/(l0*l0*l0)*((1.0/(l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*pow(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0,2.0))/(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))-1.0)*(dy1p*(l0*l0*l0)+(s*s)*y1p*6.0-(s*s)*y2p*6.0+dy1p*l0*(s*s)*3.0-dy1p*(l0*l0)*s*4.0+dy2p*l0*(s*s)*3.0-dy2p*(l0*l0)*s*2.0-l0*s*y1p*6.0+l0*s*y2p*6.0)+(1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*(dx1p*(l0*l0*l0)+(s*s)*x1p*6.0-(s*s)*x2p*6.0+dx1p*l0*(s*s)*3.0-dx1p*(l0*l0)*s*4.0+dx2p*l0*(s*s)*3.0-dx2p*(l0*l0)*s*2.0-l0*s*x1p*6.0+l0*s*x2p*6.0)*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0))/(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)))*1.0/sqrt(1.0/(l0*l0*l0*l0*l0*l0)*pow(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0,2.0)+1.0/(l0*l0*l0*l0*l0*l0)*pow(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0,2.0))*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0))*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)+1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*((1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(1.0/(l0*l0*l0)*((1.0/(l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*pow(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0,2.0))/(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))-1.0)*(dz1p*(l0*l0*l0)+(s*s)*z1p*6.0-(s*s)*z2p*6.0+dz1p*l0*(s*s)*3.0-dz1p*(l0*l0)*s*4.0+dz2p*l0*(s*s)*3.0-dz2p*(l0*l0)*s*2.0-l0*s*z1p*6.0+l0*s*z2p*6.0)+(1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*(dx1p*(l0*l0*l0)+(s*s)*x1p*6.0-(s*s)*x2p*6.0+dx1p*l0*(s*s)*3.0-dx1p*(l0*l0)*s*4.0+dx2p*l0*(s*s)*3.0-dx2p*(l0*l0)*s*2.0-l0*s*x1p*6.0+l0*s*x2p*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0))/(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))+(1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*(dy1p*(l0*l0*l0)+(s*s)*y1p*6.0-(s*s)*y2p*6.0+dy1p*l0*(s*s)*3.0-dy1p*(l0*l0)*s*4.0+dy2p*l0*(s*s)*3.0-dy2p*(l0*l0)*s*2.0-l0*s*y1p*6.0+l0*s*y2p*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0))/(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0)))*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0))/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)))+1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*(1.0/(l0*l0*l0)*((1.0/(l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*pow(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0,2.0))/(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))-1.0)*(dy1p*(l0*l0*l0)+(s*s)*y1p*6.0-(s*s)*y2p*6.0+dy1p*l0*(s*s)*3.0-dy1p*(l0*l0)*s*4.0+dy2p*l0*(s*s)*3.0-dy2p*(l0*l0)*s*2.0-l0*s*y1p*6.0+l0*s*y2p*6.0)+(1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*(dx1p*(l0*l0*l0)+(s*s)*x1p*6.0-(s*s)*x2p*6.0+dx1p*l0*(s*s)*3.0-dx1p*(l0*l0)*s*4.0+dx2p*l0*(s*s)*3.0-dx2p*(l0*l0)*s*2.0-l0*s*x1p*6.0+l0*s*x2p*6.0)*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0))/(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)))*1.0/sqrt(1.0/(l0*l0*l0*l0*l0*l0)*pow(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0,2.0)+1.0/(l0*l0*l0*l0*l0*l0)*pow(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0,2.0))*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0))*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0);
    ang(2) = (1.0/(l0*l0*l0*l0*l0*l0)*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*((s*s*s*s)*x1*y1p*3.6E1-(s*s*s*s)*x1p*y1*3.6E1-(s*s*s*s)*x1*y2p*3.6E1-(s*s*s*s)*x2*y1p*3.6E1+(s*s*s*s)*x1p*y2*3.6E1+(s*s*s*s)*x2p*y1*3.6E1+(s*s*s*s)*x2*y2p*3.6E1-(s*s*s*s)*x2p*y2*3.6E1+dx1*dy1p*(l0*l0*l0*l0*l0*l0)-dx1p*dy1*(l0*l0*l0*l0*l0*l0)-dx1*dy1p*(l0*l0*l0*l0*l0)*s*8.0+dx1p*dy1*(l0*l0*l0*l0*l0)*s*8.0-dx1*dy2p*(l0*l0*l0*l0*l0)*s*2.0-dx2*dy1p*(l0*l0*l0*l0*l0)*s*2.0+dx1p*dy2*(l0*l0*l0*l0*l0)*s*2.0+dx2p*dy1*(l0*l0*l0*l0*l0)*s*2.0+dy1p*l0*(s*s*s*s)*x1*1.8E1-dy1p*(l0*l0*l0*l0)*s*x1*6.0-dy1p*l0*(s*s*s*s)*x2*1.8E1+dy1p*(l0*l0*l0*l0)*s*x2*6.0+dy2p*l0*(s*s*s*s)*x1*1.8E1-dy2p*l0*(s*s*s*s)*x2*1.8E1-dy1*l0*(s*s*s*s)*x1p*1.8E1+dy1*(l0*l0*l0*l0)*s*x1p*6.0+dy1*l0*(s*s*s*s)*x2p*1.8E1-dy1*(l0*l0*l0*l0)*s*x2p*6.0-dy2*l0*(s*s*s*s)*x1p*1.8E1+dy2*l0*(s*s*s*s)*x2p*1.8E1-dx1p*l0*(s*s*s*s)*y1*1.8E1+dx1p*(l0*l0*l0*l0)*s*y1*6.0+dx1p*l0*(s*s*s*s)*y2*1.8E1-dx1p*(l0*l0*l0*l0)*s*y2*6.0-dx2p*l0*(s*s*s*s)*y1*1.8E1+dx2p*l0*(s*s*s*s)*y2*1.8E1+dx1*l0*(s*s*s*s)*y1p*1.8E1-dx1*(l0*l0*l0*l0)*s*y1p*6.0-dx1*l0*(s*s*s*s)*y2p*1.8E1+dx1*(l0*l0*l0*l0)*s*y2p*6.0+dx2*l0*(s*s*s*s)*y1p*1.8E1-dx2*l0*(s*s*s*s)*y2p*1.8E1-l0*(s*s*s)*x1*y1p*7.2E1+l0*(s*s*s)*x1p*y1*7.2E1+l0*(s*s*s)*x1*y2p*7.2E1+l0*(s*s*s)*x2*y1p*7.2E1-l0*(s*s*s)*x1p*y2*7.2E1-l0*(s*s*s)*x2p*y1*7.2E1-l0*(s*s*s)*x2*y2p*7.2E1+l0*(s*s*s)*x2p*y2*7.2E1+dx1*dy1p*(l0*l0)*(s*s*s*s)*9.0-dx1*dy1p*(l0*l0*l0)*(s*s*s)*2.4E1+dx1*dy1p*(l0*l0*l0*l0)*(s*s)*2.2E1-dx1p*dy1*(l0*l0)*(s*s*s*s)*9.0+dx1p*dy1*(l0*l0*l0)*(s*s*s)*2.4E1-dx1p*dy1*(l0*l0*l0*l0)*(s*s)*2.2E1+dx1*dy2p*(l0*l0)*(s*s*s*s)*9.0-dx1*dy2p*(l0*l0*l0)*(s*s*s)*1.8E1+dx1*dy2p*(l0*l0*l0*l0)*(s*s)*1.1E1+dx2*dy1p*(l0*l0)*(s*s*s*s)*9.0-dx2*dy1p*(l0*l0*l0)*(s*s*s)*1.8E1+dx2*dy1p*(l0*l0*l0*l0)*(s*s)*1.1E1-dx1p*dy2*(l0*l0)*(s*s*s*s)*9.0+dx1p*dy2*(l0*l0*l0)*(s*s*s)*1.8E1-dx1p*dy2*(l0*l0*l0*l0)*(s*s)*1.1E1-dx2p*dy1*(l0*l0)*(s*s*s*s)*9.0+dx2p*dy1*(l0*l0*l0)*(s*s*s)*1.8E1-dx2p*dy1*(l0*l0*l0*l0)*(s*s)*1.1E1+dx2*dy2p*(l0*l0)*(s*s*s*s)*9.0-dx2*dy2p*(l0*l0*l0)*(s*s*s)*1.2E1+dx2*dy2p*(l0*l0*l0*l0)*(s*s)*4.0-dx2p*dy2*(l0*l0)*(s*s*s*s)*9.0+dx2p*dy2*(l0*l0*l0)*(s*s*s)*1.2E1-dx2p*dy2*(l0*l0*l0*l0)*(s*s)*4.0-dy1p*(l0*l0)*(s*s*s)*x1*4.2E1+dy1p*(l0*l0*l0)*(s*s)*x1*3.0E1+dy1p*(l0*l0)*(s*s*s)*x2*4.2E1-dy1p*(l0*l0*l0)*(s*s)*x2*3.0E1-dy2p*(l0*l0)*(s*s*s)*x1*3.0E1+dy2p*(l0*l0*l0)*(s*s)*x1*1.2E1+dy2p*(l0*l0)*(s*s*s)*x2*3.0E1-dy2p*(l0*l0*l0)*(s*s)*x2*1.2E1+dy1*(l0*l0)*(s*s*s)*x1p*4.2E1-dy1*(l0*l0*l0)*(s*s)*x1p*3.0E1-dy1*(l0*l0)*(s*s*s)*x2p*4.2E1+dy1*(l0*l0*l0)*(s*s)*x2p*3.0E1+dy2*(l0*l0)*(s*s*s)*x1p*3.0E1-dy2*(l0*l0*l0)*(s*s)*x1p*1.2E1-dy2*(l0*l0)*(s*s*s)*x2p*3.0E1+dy2*(l0*l0*l0)*(s*s)*x2p*1.2E1+dx1p*(l0*l0)*(s*s*s)*y1*4.2E1-dx1p*(l0*l0*l0)*(s*s)*y1*3.0E1-dx1p*(l0*l0)*(s*s*s)*y2*4.2E1+dx1p*(l0*l0*l0)*(s*s)*y2*3.0E1+dx2p*(l0*l0)*(s*s*s)*y1*3.0E1-dx2p*(l0*l0*l0)*(s*s)*y1*1.2E1-dx2p*(l0*l0)*(s*s*s)*y2*3.0E1+dx2p*(l0*l0*l0)*(s*s)*y2*1.2E1-dx1*(l0*l0)*(s*s*s)*y1p*4.2E1+dx1*(l0*l0*l0)*(s*s)*y1p*3.0E1+dx1*(l0*l0)*(s*s*s)*y2p*4.2E1-dx1*(l0*l0*l0)*(s*s)*y2p*3.0E1-dx2*(l0*l0)*(s*s*s)*y1p*3.0E1+dx2*(l0*l0*l0)*(s*s)*y1p*1.2E1+dx2*(l0*l0)*(s*s*s)*y2p*3.0E1-dx2*(l0*l0*l0)*(s*s)*y2p*1.2E1+(l0*l0)*(s*s)*x1*y1p*3.6E1-(l0*l0)*(s*s)*x1p*y1*3.6E1-(l0*l0)*(s*s)*x1*y2p*3.6E1-(l0*l0)*(s*s)*x2*y1p*3.6E1+(l0*l0)*(s*s)*x1p*y2*3.6E1+(l0*l0)*(s*s)*x2p*y1*3.6E1+(l0*l0)*(s*s)*x2*y2p*3.6E1-(l0*l0)*(s*s)*x2p*y2*3.6E1))/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    
    return (computeOrientation(qElement,cp)*ang).copy();
  }

  Vec FiniteElement1s33ANCF::LocateBalken(const Vec& qElement, const double& s) {
    Vec X(6);
    X(Index(0,2)) = (computePosition(qElement,ContourPointData(s))).copy();
    X(Index(3,5)) = AIK2Cardan(computeOrientation(qElement,ContourPointData(s)));

    return X.copy();
  }

  Vec FiniteElement1s33ANCF::StateBalken(const Vec& qElement, const Vec& qpElement, const double& s) {
    Mat J = (JGeneralized(qElement,s).T()).copy();

    Vec X(12);
    X(Index(0,2)) = J(Index(0,2),Index(0,11))*qElement;
    X(Index(3,5)) = AIK2Cardan(computeOrientation(qElement,ContourPointData(s)));
    X(Index(6,11)) = J*qpElement;

    return X.copy();
  }

  Mat FiniteElement1s33ANCF::JGeneralized(const Vec& qElement, const double& s) {
    Mat J(12,6,INIT,0.);

    const double & x1 = qElement(0);    const double & y1 = qElement(1);     const double & z1 = qElement(2);
    const double &dx1 = qElement(3);    const double &dy1 = qElement(4);     const double &dz1 = qElement(5);
    const double & x2 = qElement(6);    const double & y2 = qElement(7);     const double & z2 = qElement(8);
    const double &dx2 = qElement(9);    const double &dy2 = qElement(10);    const double &dz2 = qElement(11);

    // calculate matrix of global shape functions
    Mat S = GlobalShapeFunctions(s);

    // Jacobian
    // first three colums, i.e. Jacobian of translation, correlate with matrix of global shape functions S
    J(Index(0,11),Index(0,2)) = S(Index(0,11),Index(0,2)).copy();

    // last three colums represent the Jacobian of rotation
    J(0,3) = 1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*s*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0-s)*1.0/sqrt(1.0/(l0*l0*l0*l0*l0*l0)*pow(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0,2.0)+1.0/(l0*l0*l0*l0*l0*l0)*pow(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0,2.0))*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*6.0;
    J(1,3) = 1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*s*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0-s)*1.0/sqrt(1.0/(l0*l0*l0*l0*l0*l0)*pow(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0,2.0)+1.0/(l0*l0*l0*l0*l0*l0)*pow(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0,2.0))*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*-6.0;
    J(3,3) = -1.0/(l0*l0*l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*1.0/sqrt(1.0/(l0*l0*l0*l0*l0*l0)*pow(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0,2.0)+1.0/(l0*l0*l0*l0*l0*l0)*pow(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0,2.0))*(l0*s*-4.0+l0*l0+(s*s)*3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0);
    J(4,3) = 1.0/(l0*l0*l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*1.0/sqrt(1.0/(l0*l0*l0*l0*l0*l0)*pow(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0,2.0)+1.0/(l0*l0*l0*l0*l0*l0)*pow(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0,2.0))*(l0*s*-4.0+l0*l0+(s*s)*3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0);
    J(6,3) = 1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*s*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0-s)*1.0/sqrt(1.0/(l0*l0*l0*l0*l0*l0)*pow(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0,2.0)+1.0/(l0*l0*l0*l0*l0*l0)*pow(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0,2.0))*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*-6.0;
    J(7,3) = 1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*s*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0-s)*1.0/sqrt(1.0/(l0*l0*l0*l0*l0*l0)*pow(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0,2.0)+1.0/(l0*l0*l0*l0*l0*l0)*pow(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0,2.0))*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*6.0;
    J(9,3) = 1.0/(l0*l0*l0*l0*l0*l0*l0*l0)*s*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*1.0/sqrt(1.0/(l0*l0*l0*l0*l0*l0)*pow(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0,2.0)+1.0/(l0*l0*l0*l0*l0*l0)*pow(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0,2.0))*(l0*2.0-s*3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0);
    J(10,3) = -1.0/(l0*l0*l0*l0*l0*l0*l0*l0)*s*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*1.0/sqrt(1.0/(l0*l0*l0*l0*l0*l0)*pow(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0,2.0)+1.0/(l0*l0*l0*l0*l0*l0)*pow(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0,2.0))*(l0*2.0-s*3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0);
    
    J(0,4) = (1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*s*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0-s)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*-6.0)/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    J(1,4) = (1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*s*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0-s)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*-6.0)/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    J(2,4) = (1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*s*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0-s)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*((s*s*s*s)*(x1*x1)*3.6E1+(s*s*s*s)*(x2*x2)*3.6E1+(s*s*s*s)*(y1*y1)*3.6E1+(s*s*s*s)*(y2*y2)*3.6E1+(dx1*dx1)*(l0*l0*l0*l0*l0*l0)+(dy1*dy1)*(l0*l0*l0*l0*l0*l0)-(s*s*s*s)*x1*x2*7.2E1-(s*s*s*s)*y1*y2*7.2E1-(dx1*dx1)*(l0*l0*l0*l0*l0)*s*8.0-(dy1*dy1)*(l0*l0*l0*l0*l0)*s*8.0-l0*(s*s*s)*(x1*x1)*7.2E1-l0*(s*s*s)*(x2*x2)*7.2E1-l0*(s*s*s)*(y1*y1)*7.2E1-l0*(s*s*s)*(y2*y2)*7.2E1+(dx1*dx1)*(l0*l0)*(s*s*s*s)*9.0-(dx1*dx1)*(l0*l0*l0)*(s*s*s)*2.4E1+(dx1*dx1)*(l0*l0*l0*l0)*(s*s)*2.2E1+(dx2*dx2)*(l0*l0)*(s*s*s*s)*9.0-(dx2*dx2)*(l0*l0*l0)*(s*s*s)*1.2E1+(dx2*dx2)*(l0*l0*l0*l0)*(s*s)*4.0+(dy1*dy1)*(l0*l0)*(s*s*s*s)*9.0-(dy1*dy1)*(l0*l0*l0)*(s*s*s)*2.4E1+(dy1*dy1)*(l0*l0*l0*l0)*(s*s)*2.2E1+(dy2*dy2)*(l0*l0)*(s*s*s*s)*9.0-(dy2*dy2)*(l0*l0*l0)*(s*s*s)*1.2E1+(dy2*dy2)*(l0*l0*l0*l0)*(s*s)*4.0+(l0*l0)*(s*s)*(x1*x1)*3.6E1+(l0*l0)*(s*s)*(x2*x2)*3.6E1+(l0*l0)*(s*s)*(y1*y1)*3.6E1+(l0*l0)*(s*s)*(y2*y2)*3.6E1-dx1*dx2*(l0*l0*l0*l0*l0)*s*4.0-dy1*dy2*(l0*l0*l0*l0*l0)*s*4.0+dx1*l0*(s*s*s*s)*x1*3.6E1-dx1*(l0*l0*l0*l0)*s*x1*1.2E1-dx1*l0*(s*s*s*s)*x2*3.6E1+dx1*(l0*l0*l0*l0)*s*x2*1.2E1+dx2*l0*(s*s*s*s)*x1*3.6E1-dx2*l0*(s*s*s*s)*x2*3.6E1+dy1*l0*(s*s*s*s)*y1*3.6E1-dy1*(l0*l0*l0*l0)*s*y1*1.2E1-dy1*l0*(s*s*s*s)*y2*3.6E1+dy1*(l0*l0*l0*l0)*s*y2*1.2E1+dy2*l0*(s*s*s*s)*y1*3.6E1-dy2*l0*(s*s*s*s)*y2*3.6E1+l0*(s*s*s)*x1*x2*1.44E2+l0*(s*s*s)*y1*y2*1.44E2+dx1*dx2*(l0*l0)*(s*s*s*s)*1.8E1-dx1*dx2*(l0*l0*l0)*(s*s*s)*3.6E1+dx1*dx2*(l0*l0*l0*l0)*(s*s)*2.2E1+dy1*dy2*(l0*l0)*(s*s*s*s)*1.8E1-dy1*dy2*(l0*l0*l0)*(s*s*s)*3.6E1+dy1*dy2*(l0*l0*l0*l0)*(s*s)*2.2E1-dx1*(l0*l0)*(s*s*s)*x1*8.4E1+dx1*(l0*l0*l0)*(s*s)*x1*6.0E1+dx1*(l0*l0)*(s*s*s)*x2*8.4E1-dx1*(l0*l0*l0)*(s*s)*x2*6.0E1-dx2*(l0*l0)*(s*s*s)*x1*6.0E1+dx2*(l0*l0*l0)*(s*s)*x1*2.4E1+dx2*(l0*l0)*(s*s*s)*x2*6.0E1-dx2*(l0*l0*l0)*(s*s)*x2*2.4E1-dy1*(l0*l0)*(s*s*s)*y1*8.4E1+dy1*(l0*l0*l0)*(s*s)*y1*6.0E1+dy1*(l0*l0)*(s*s*s)*y2*8.4E1-dy1*(l0*l0*l0)*(s*s)*y2*6.0E1-dy2*(l0*l0)*(s*s*s)*y1*6.0E1+dy2*(l0*l0*l0)*(s*s)*y1*2.4E1+dy2*(l0*l0)*(s*s*s)*y2*6.0E1-dy2*(l0*l0*l0)*(s*s)*y2*2.4E1-(l0*l0)*(s*s)*x1*x2*7.2E1-(l0*l0)*(s*s)*y1*y2*7.2E1)*6.0)/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    J(3,4) = (1.0/(l0*l0*l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0*s*-4.0+l0*l0+(s*s)*3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0))/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    J(4,4) = (1.0/(l0*l0*l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0*s*-4.0+l0*l0+(s*s)*3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0))/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    J(5,4) = -(1.0/(l0*l0*l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0*s*-4.0+l0*l0+(s*s)*3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*((s*s*s*s)*(x1*x1)*3.6E1+(s*s*s*s)*(x2*x2)*3.6E1+(s*s*s*s)*(y1*y1)*3.6E1+(s*s*s*s)*(y2*y2)*3.6E1+(dx1*dx1)*(l0*l0*l0*l0*l0*l0)+(dy1*dy1)*(l0*l0*l0*l0*l0*l0)-(s*s*s*s)*x1*x2*7.2E1-(s*s*s*s)*y1*y2*7.2E1-(dx1*dx1)*(l0*l0*l0*l0*l0)*s*8.0-(dy1*dy1)*(l0*l0*l0*l0*l0)*s*8.0-l0*(s*s*s)*(x1*x1)*7.2E1-l0*(s*s*s)*(x2*x2)*7.2E1-l0*(s*s*s)*(y1*y1)*7.2E1-l0*(s*s*s)*(y2*y2)*7.2E1+(dx1*dx1)*(l0*l0)*(s*s*s*s)*9.0-(dx1*dx1)*(l0*l0*l0)*(s*s*s)*2.4E1+(dx1*dx1)*(l0*l0*l0*l0)*(s*s)*2.2E1+(dx2*dx2)*(l0*l0)*(s*s*s*s)*9.0-(dx2*dx2)*(l0*l0*l0)*(s*s*s)*1.2E1+(dx2*dx2)*(l0*l0*l0*l0)*(s*s)*4.0+(dy1*dy1)*(l0*l0)*(s*s*s*s)*9.0-(dy1*dy1)*(l0*l0*l0)*(s*s*s)*2.4E1+(dy1*dy1)*(l0*l0*l0*l0)*(s*s)*2.2E1+(dy2*dy2)*(l0*l0)*(s*s*s*s)*9.0-(dy2*dy2)*(l0*l0*l0)*(s*s*s)*1.2E1+(dy2*dy2)*(l0*l0*l0*l0)*(s*s)*4.0+(l0*l0)*(s*s)*(x1*x1)*3.6E1+(l0*l0)*(s*s)*(x2*x2)*3.6E1+(l0*l0)*(s*s)*(y1*y1)*3.6E1+(l0*l0)*(s*s)*(y2*y2)*3.6E1-dx1*dx2*(l0*l0*l0*l0*l0)*s*4.0-dy1*dy2*(l0*l0*l0*l0*l0)*s*4.0+dx1*l0*(s*s*s*s)*x1*3.6E1-dx1*(l0*l0*l0*l0)*s*x1*1.2E1-dx1*l0*(s*s*s*s)*x2*3.6E1+dx1*(l0*l0*l0*l0)*s*x2*1.2E1+dx2*l0*(s*s*s*s)*x1*3.6E1-dx2*l0*(s*s*s*s)*x2*3.6E1+dy1*l0*(s*s*s*s)*y1*3.6E1-dy1*(l0*l0*l0*l0)*s*y1*1.2E1-dy1*l0*(s*s*s*s)*y2*3.6E1+dy1*(l0*l0*l0*l0)*s*y2*1.2E1+dy2*l0*(s*s*s*s)*y1*3.6E1-dy2*l0*(s*s*s*s)*y2*3.6E1+l0*(s*s*s)*x1*x2*1.44E2+l0*(s*s*s)*y1*y2*1.44E2+dx1*dx2*(l0*l0)*(s*s*s*s)*1.8E1-dx1*dx2*(l0*l0*l0)*(s*s*s)*3.6E1+dx1*dx2*(l0*l0*l0*l0)*(s*s)*2.2E1+dy1*dy2*(l0*l0)*(s*s*s*s)*1.8E1-dy1*dy2*(l0*l0*l0)*(s*s*s)*3.6E1+dy1*dy2*(l0*l0*l0*l0)*(s*s)*2.2E1-dx1*(l0*l0)*(s*s*s)*x1*8.4E1+dx1*(l0*l0*l0)*(s*s)*x1*6.0E1+dx1*(l0*l0)*(s*s*s)*x2*8.4E1-dx1*(l0*l0*l0)*(s*s)*x2*6.0E1-dx2*(l0*l0)*(s*s*s)*x1*6.0E1+dx2*(l0*l0*l0)*(s*s)*x1*2.4E1+dx2*(l0*l0)*(s*s*s)*x2*6.0E1-dx2*(l0*l0*l0)*(s*s)*x2*2.4E1-dy1*(l0*l0)*(s*s*s)*y1*8.4E1+dy1*(l0*l0*l0)*(s*s)*y1*6.0E1+dy1*(l0*l0)*(s*s*s)*y2*8.4E1-dy1*(l0*l0*l0)*(s*s)*y2*6.0E1-dy2*(l0*l0)*(s*s*s)*y1*6.0E1+dy2*(l0*l0*l0)*(s*s)*y1*2.4E1+dy2*(l0*l0)*(s*s*s)*y2*6.0E1-dy2*(l0*l0*l0)*(s*s)*y2*2.4E1-(l0*l0)*(s*s)*x1*x2*7.2E1-(l0*l0)*(s*s)*y1*y2*7.2E1))/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    J(6,4) = (1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*s*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0-s)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*6.0)/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    J(7,4) = (1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*s*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0-s)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*6.0)/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    J(8,4) = (1.0/(l0*l0*l0*l0*l0*l0*l0*l0*l0)*s*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0-s)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*((s*s*s*s)*(x1*x1)*3.6E1+(s*s*s*s)*(x2*x2)*3.6E1+(s*s*s*s)*(y1*y1)*3.6E1+(s*s*s*s)*(y2*y2)*3.6E1+(dx1*dx1)*(l0*l0*l0*l0*l0*l0)+(dy1*dy1)*(l0*l0*l0*l0*l0*l0)-(s*s*s*s)*x1*x2*7.2E1-(s*s*s*s)*y1*y2*7.2E1-(dx1*dx1)*(l0*l0*l0*l0*l0)*s*8.0-(dy1*dy1)*(l0*l0*l0*l0*l0)*s*8.0-l0*(s*s*s)*(x1*x1)*7.2E1-l0*(s*s*s)*(x2*x2)*7.2E1-l0*(s*s*s)*(y1*y1)*7.2E1-l0*(s*s*s)*(y2*y2)*7.2E1+(dx1*dx1)*(l0*l0)*(s*s*s*s)*9.0-(dx1*dx1)*(l0*l0*l0)*(s*s*s)*2.4E1+(dx1*dx1)*(l0*l0*l0*l0)*(s*s)*2.2E1+(dx2*dx2)*(l0*l0)*(s*s*s*s)*9.0-(dx2*dx2)*(l0*l0*l0)*(s*s*s)*1.2E1+(dx2*dx2)*(l0*l0*l0*l0)*(s*s)*4.0+(dy1*dy1)*(l0*l0)*(s*s*s*s)*9.0-(dy1*dy1)*(l0*l0*l0)*(s*s*s)*2.4E1+(dy1*dy1)*(l0*l0*l0*l0)*(s*s)*2.2E1+(dy2*dy2)*(l0*l0)*(s*s*s*s)*9.0-(dy2*dy2)*(l0*l0*l0)*(s*s*s)*1.2E1+(dy2*dy2)*(l0*l0*l0*l0)*(s*s)*4.0+(l0*l0)*(s*s)*(x1*x1)*3.6E1+(l0*l0)*(s*s)*(x2*x2)*3.6E1+(l0*l0)*(s*s)*(y1*y1)*3.6E1+(l0*l0)*(s*s)*(y2*y2)*3.6E1-dx1*dx2*(l0*l0*l0*l0*l0)*s*4.0-dy1*dy2*(l0*l0*l0*l0*l0)*s*4.0+dx1*l0*(s*s*s*s)*x1*3.6E1-dx1*(l0*l0*l0*l0)*s*x1*1.2E1-dx1*l0*(s*s*s*s)*x2*3.6E1+dx1*(l0*l0*l0*l0)*s*x2*1.2E1+dx2*l0*(s*s*s*s)*x1*3.6E1-dx2*l0*(s*s*s*s)*x2*3.6E1+dy1*l0*(s*s*s*s)*y1*3.6E1-dy1*(l0*l0*l0*l0)*s*y1*1.2E1-dy1*l0*(s*s*s*s)*y2*3.6E1+dy1*(l0*l0*l0*l0)*s*y2*1.2E1+dy2*l0*(s*s*s*s)*y1*3.6E1-dy2*l0*(s*s*s*s)*y2*3.6E1+l0*(s*s*s)*x1*x2*1.44E2+l0*(s*s*s)*y1*y2*1.44E2+dx1*dx2*(l0*l0)*(s*s*s*s)*1.8E1-dx1*dx2*(l0*l0*l0)*(s*s*s)*3.6E1+dx1*dx2*(l0*l0*l0*l0)*(s*s)*2.2E1+dy1*dy2*(l0*l0)*(s*s*s*s)*1.8E1-dy1*dy2*(l0*l0*l0)*(s*s*s)*3.6E1+dy1*dy2*(l0*l0*l0*l0)*(s*s)*2.2E1-dx1*(l0*l0)*(s*s*s)*x1*8.4E1+dx1*(l0*l0*l0)*(s*s)*x1*6.0E1+dx1*(l0*l0)*(s*s*s)*x2*8.4E1-dx1*(l0*l0*l0)*(s*s)*x2*6.0E1-dx2*(l0*l0)*(s*s*s)*x1*6.0E1+dx2*(l0*l0*l0)*(s*s)*x1*2.4E1+dx2*(l0*l0)*(s*s*s)*x2*6.0E1-dx2*(l0*l0*l0)*(s*s)*x2*2.4E1-dy1*(l0*l0)*(s*s*s)*y1*8.4E1+dy1*(l0*l0*l0)*(s*s)*y1*6.0E1+dy1*(l0*l0)*(s*s*s)*y2*8.4E1-dy1*(l0*l0*l0)*(s*s)*y2*6.0E1-dy2*(l0*l0)*(s*s*s)*y1*6.0E1+dy2*(l0*l0*l0)*(s*s)*y1*2.4E1+dy2*(l0*l0)*(s*s*s)*y2*6.0E1-dy2*(l0*l0*l0)*(s*s)*y2*2.4E1-(l0*l0)*(s*s)*x1*x2*7.2E1-(l0*l0)*(s*s)*y1*y2*7.2E1)*-6.0)/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    J(9,4) = -(1.0/(l0*l0*l0*l0*l0*l0*l0*l0)*s*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0*2.0-s*3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0))/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    J(10,4) = -(1.0/(l0*l0*l0*l0*l0*l0*l0*l0)*s*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0*2.0-s*3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0))/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    J(11,4) = (1.0/(l0*l0*l0*l0*l0*l0*l0*l0)*s*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0*2.0-s*3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*((s*s*s*s)*(x1*x1)*3.6E1+(s*s*s*s)*(x2*x2)*3.6E1+(s*s*s*s)*(y1*y1)*3.6E1+(s*s*s*s)*(y2*y2)*3.6E1+(dx1*dx1)*(l0*l0*l0*l0*l0*l0)+(dy1*dy1)*(l0*l0*l0*l0*l0*l0)-(s*s*s*s)*x1*x2*7.2E1-(s*s*s*s)*y1*y2*7.2E1-(dx1*dx1)*(l0*l0*l0*l0*l0)*s*8.0-(dy1*dy1)*(l0*l0*l0*l0*l0)*s*8.0-l0*(s*s*s)*(x1*x1)*7.2E1-l0*(s*s*s)*(x2*x2)*7.2E1-l0*(s*s*s)*(y1*y1)*7.2E1-l0*(s*s*s)*(y2*y2)*7.2E1+(dx1*dx1)*(l0*l0)*(s*s*s*s)*9.0-(dx1*dx1)*(l0*l0*l0)*(s*s*s)*2.4E1+(dx1*dx1)*(l0*l0*l0*l0)*(s*s)*2.2E1+(dx2*dx2)*(l0*l0)*(s*s*s*s)*9.0-(dx2*dx2)*(l0*l0*l0)*(s*s*s)*1.2E1+(dx2*dx2)*(l0*l0*l0*l0)*(s*s)*4.0+(dy1*dy1)*(l0*l0)*(s*s*s*s)*9.0-(dy1*dy1)*(l0*l0*l0)*(s*s*s)*2.4E1+(dy1*dy1)*(l0*l0*l0*l0)*(s*s)*2.2E1+(dy2*dy2)*(l0*l0)*(s*s*s*s)*9.0-(dy2*dy2)*(l0*l0*l0)*(s*s*s)*1.2E1+(dy2*dy2)*(l0*l0*l0*l0)*(s*s)*4.0+(l0*l0)*(s*s)*(x1*x1)*3.6E1+(l0*l0)*(s*s)*(x2*x2)*3.6E1+(l0*l0)*(s*s)*(y1*y1)*3.6E1+(l0*l0)*(s*s)*(y2*y2)*3.6E1-dx1*dx2*(l0*l0*l0*l0*l0)*s*4.0-dy1*dy2*(l0*l0*l0*l0*l0)*s*4.0+dx1*l0*(s*s*s*s)*x1*3.6E1-dx1*(l0*l0*l0*l0)*s*x1*1.2E1-dx1*l0*(s*s*s*s)*x2*3.6E1+dx1*(l0*l0*l0*l0)*s*x2*1.2E1+dx2*l0*(s*s*s*s)*x1*3.6E1-dx2*l0*(s*s*s*s)*x2*3.6E1+dy1*l0*(s*s*s*s)*y1*3.6E1-dy1*(l0*l0*l0*l0)*s*y1*1.2E1-dy1*l0*(s*s*s*s)*y2*3.6E1+dy1*(l0*l0*l0*l0)*s*y2*1.2E1+dy2*l0*(s*s*s*s)*y1*3.6E1-dy2*l0*(s*s*s*s)*y2*3.6E1+l0*(s*s*s)*x1*x2*1.44E2+l0*(s*s*s)*y1*y2*1.44E2+dx1*dx2*(l0*l0)*(s*s*s*s)*1.8E1-dx1*dx2*(l0*l0*l0)*(s*s*s)*3.6E1+dx1*dx2*(l0*l0*l0*l0)*(s*s)*2.2E1+dy1*dy2*(l0*l0)*(s*s*s*s)*1.8E1-dy1*dy2*(l0*l0*l0)*(s*s*s)*3.6E1+dy1*dy2*(l0*l0*l0*l0)*(s*s)*2.2E1-dx1*(l0*l0)*(s*s*s)*x1*8.4E1+dx1*(l0*l0*l0)*(s*s)*x1*6.0E1+dx1*(l0*l0)*(s*s*s)*x2*8.4E1-dx1*(l0*l0*l0)*(s*s)*x2*6.0E1-dx2*(l0*l0)*(s*s*s)*x1*6.0E1+dx2*(l0*l0*l0)*(s*s)*x1*2.4E1+dx2*(l0*l0)*(s*s*s)*x2*6.0E1-dx2*(l0*l0*l0)*(s*s)*x2*2.4E1-dy1*(l0*l0)*(s*s*s)*y1*8.4E1+dy1*(l0*l0*l0)*(s*s)*y1*6.0E1+dy1*(l0*l0)*(s*s*s)*y2*8.4E1-dy1*(l0*l0*l0)*(s*s)*y2*6.0E1-dy2*(l0*l0)*(s*s*s)*y1*6.0E1+dy2*(l0*l0*l0)*(s*s)*y1*2.4E1+dy2*(l0*l0)*(s*s*s)*y2*6.0E1-dy2*(l0*l0*l0)*(s*s)*y2*2.4E1-(l0*l0)*(s*s)*x1*x2*7.2E1-(l0*l0)*(s*s)*y1*y2*7.2E1))/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    
    J(0,5) = (1.0/(l0*l0*l0*l0*l0*l0)*s*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0-s)*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*6.0)/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    J(1,5) = (1.0/(l0*l0*l0*l0*l0*l0)*s*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0-s)*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*-6.0)/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    J(3,5) = -(1.0/(l0*l0*l0*l0*l0)*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0*s*-4.0+l0*l0+(s*s)*3.0)*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0))/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    J(4,5) = (1.0/(l0*l0*l0*l0*l0)*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0*s*-4.0+l0*l0+(s*s)*3.0)*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0))/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    J(6,5) = (1.0/(l0*l0*l0*l0*l0*l0)*s*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0-s)*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*-6.0)/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    J(7,5) = (1.0/(l0*l0*l0*l0*l0*l0)*s*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0-s)*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*6.0)/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    J(9,5) = (1.0/(l0*l0*l0*l0*l0)*s*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0*2.0-s*3.0)*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0))/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    J(10,5) = -(1.0/(l0*l0*l0*l0*l0)*s*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(l0*2.0-s*3.0)*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0))/max(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*1.0/pow(fabs(l0),3.0),max(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*1.0/pow(fabs(l0),3.0),fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0)*1.0/pow(fabs(l0),3.0)));
    
    J(Index(0,11),Index(3,5)) = (J(Index(0,11),Index(3,5))*computeOrientation(qElement,ContourPointData(s)).T()).copy();

    return J.copy();
  }

  Mat FiniteElement1s33ANCF::GlobalShapeFunctions(const double& s) {
    Mat S(12,3,INIT,0.);

    S(0,0) = 1.0/(l0*l0)*(s*s)*-3.0+1.0/(l0*l0*l0)*(s*s*s)*2.0+1.0;
    S(3,0) = l0*(s/l0-1.0/(l0*l0)*(s*s)*2.0+1.0/(l0*l0*l0)*(s*s*s));
    S(6,0) = 1.0/(l0*l0)*(s*s)*3.0-1.0/(l0*l0*l0)*(s*s*s)*2.0;
    S(9,0) = -l0*(1.0/(l0*l0)*(s*s)-1.0/(l0*l0*l0)*(s*s*s));
    S(1,1) = 1.0/(l0*l0)*(s*s)*-3.0+1.0/(l0*l0*l0)*(s*s*s)*2.0+1.0;
    S(4,1) = l0*(s/l0-1.0/(l0*l0)*(s*s)*2.0+1.0/(l0*l0*l0)*(s*s*s));
    S(7,1) = 1.0/(l0*l0)*(s*s)*3.0-1.0/(l0*l0*l0)*(s*s*s)*2.0;
    S(10,1) = -l0*(1.0/(l0*l0)*(s*s)-1.0/(l0*l0*l0)*(s*s*s));
    S(2,2) = 1.0/(l0*l0)*(s*s)*-3.0+1.0/(l0*l0*l0)*(s*s*s)*2.0+1.0;
    S(5,2) = l0*(s/l0-1.0/(l0*l0)*(s*s)*2.0+1.0/(l0*l0*l0)*(s*s*s));
    S(8,2) = 1.0/(l0*l0)*(s*s)*3.0-1.0/(l0*l0*l0)*(s*s*s)*2.0;
    S(11,2) = -l0*(1.0/(l0*l0)*(s*s)-1.0/(l0*l0*l0)*(s*s*s));
    
    return S.copy();
  }

  Vec FiniteElement1s33ANCF::tangent(const Vec& qElement, const double& s) {
    Vec t(3,NONINIT);

    const double & x1 = qElement(0);    const double & y1 = qElement(1);     const double & z1 = qElement(2);
    const double &dx1 = qElement(3);    const double &dy1 = qElement(4);     const double &dz1 = qElement(5);
    const double & x2 = qElement(6);    const double & y2 = qElement(7);     const double & z2 = qElement(8);
    const double &dx2 = qElement(9);    const double &dy2 = qElement(10);    const double &dz2 = qElement(11);

    t(0) = 1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0);
    t(1) = 1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0);
    t(2) = 1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0);

    return t.copy();
  }

  Vec FiniteElement1s33ANCF::normal(const Vec& qElement, const double& s) {
    Vec n(3,NONINIT);

    const double & x1 = qElement(0);    const double & y1 = qElement(1);
    const double &dx1 = qElement(3);    const double &dy1 = qElement(4);
    const double & x2 = qElement(6);    const double & y2 = qElement(7);
    const double &dx2 = qElement(9);    const double &dy2 = qElement(10);

    n(0) = -1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0);
    n(1) = 1.0/(l0*l0*l0)*pow(fabs(l0),3.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0);
    n(2) = 0.;

    return n.copy();
  }

  Vec FiniteElement1s33ANCF::binormal(const Vec& qElement, const double& s) {
    Vec b(3,NONINIT);

    const double & x1 = qElement(0);    const double & y1 = qElement(1);     const double & z1 = qElement(2);
    const double &dx1 = qElement(3);    const double &dy1 = qElement(4);     const double &dz1 = qElement(5);
    const double & x2 = qElement(6);    const double & y2 = qElement(7);     const double & z2 = qElement(8);
    const double &dx2 = qElement(9);    const double &dy2 = qElement(10);    const double &dz2 = qElement(11);

    b(0) = -1.0/(l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0);
    b(1) = -1.0/(l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0)*(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0);
    b(2) = 1.0/(l0*l0*l0*l0*l0*l0)*pow(fabs(l0),6.0)*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0))*1.0/sqrt(pow(fabs(dx1*(l0*l0*l0)+(s*s)*x1*6.0-(s*s)*x2*6.0+dx1*l0*(s*s)*3.0-dx1*(l0*l0)*s*4.0+dx2*l0*(s*s)*3.0-dx2*(l0*l0)*s*2.0-l0*s*x1*6.0+l0*s*x2*6.0),2.0)+pow(fabs(dy1*(l0*l0*l0)+(s*s)*y1*6.0-(s*s)*y2*6.0+dy1*l0*(s*s)*3.0-dy1*(l0*l0)*s*4.0+dy2*l0*(s*s)*3.0-dy2*(l0*l0)*s*2.0-l0*s*y1*6.0+l0*s*y2*6.0),2.0)+pow(fabs(dz1*(l0*l0*l0)+(s*s)*z1*6.0-(s*s)*z2*6.0+dz1*l0*(s*s)*3.0-dz1*(l0*l0)*s*4.0+dz2*l0*(s*s)*3.0-dz2*(l0*l0)*s*2.0-l0*s*z1*6.0+l0*s*z2*6.0),2.0))*((s*s*s*s)*(x1*x1)*3.6E1+(s*s*s*s)*(x2*x2)*3.6E1+(s*s*s*s)*(y1*y1)*3.6E1+(s*s*s*s)*(y2*y2)*3.6E1+(dx1*dx1)*(l0*l0*l0*l0*l0*l0)+(dy1*dy1)*(l0*l0*l0*l0*l0*l0)-(s*s*s*s)*x1*x2*7.2E1-(s*s*s*s)*y1*y2*7.2E1-(dx1*dx1)*(l0*l0*l0*l0*l0)*s*8.0-(dy1*dy1)*(l0*l0*l0*l0*l0)*s*8.0-l0*(s*s*s)*(x1*x1)*7.2E1-l0*(s*s*s)*(x2*x2)*7.2E1-l0*(s*s*s)*(y1*y1)*7.2E1-l0*(s*s*s)*(y2*y2)*7.2E1+(dx1*dx1)*(l0*l0)*(s*s*s*s)*9.0-(dx1*dx1)*(l0*l0*l0)*(s*s*s)*2.4E1+(dx1*dx1)*(l0*l0*l0*l0)*(s*s)*2.2E1+(dx2*dx2)*(l0*l0)*(s*s*s*s)*9.0-(dx2*dx2)*(l0*l0*l0)*(s*s*s)*1.2E1+(dx2*dx2)*(l0*l0*l0*l0)*(s*s)*4.0+(dy1*dy1)*(l0*l0)*(s*s*s*s)*9.0-(dy1*dy1)*(l0*l0*l0)*(s*s*s)*2.4E1+(dy1*dy1)*(l0*l0*l0*l0)*(s*s)*2.2E1+(dy2*dy2)*(l0*l0)*(s*s*s*s)*9.0-(dy2*dy2)*(l0*l0*l0)*(s*s*s)*1.2E1+(dy2*dy2)*(l0*l0*l0*l0)*(s*s)*4.0+(l0*l0)*(s*s)*(x1*x1)*3.6E1+(l0*l0)*(s*s)*(x2*x2)*3.6E1+(l0*l0)*(s*s)*(y1*y1)*3.6E1+(l0*l0)*(s*s)*(y2*y2)*3.6E1-dx1*dx2*(l0*l0*l0*l0*l0)*s*4.0-dy1*dy2*(l0*l0*l0*l0*l0)*s*4.0+dx1*l0*(s*s*s*s)*x1*3.6E1-dx1*(l0*l0*l0*l0)*s*x1*1.2E1-dx1*l0*(s*s*s*s)*x2*3.6E1+dx1*(l0*l0*l0*l0)*s*x2*1.2E1+dx2*l0*(s*s*s*s)*x1*3.6E1-dx2*l0*(s*s*s*s)*x2*3.6E1+dy1*l0*(s*s*s*s)*y1*3.6E1-dy1*(l0*l0*l0*l0)*s*y1*1.2E1-dy1*l0*(s*s*s*s)*y2*3.6E1+dy1*(l0*l0*l0*l0)*s*y2*1.2E1+dy2*l0*(s*s*s*s)*y1*3.6E1-dy2*l0*(s*s*s*s)*y2*3.6E1+l0*(s*s*s)*x1*x2*1.44E2+l0*(s*s*s)*y1*y2*1.44E2+dx1*dx2*(l0*l0)*(s*s*s*s)*1.8E1-dx1*dx2*(l0*l0*l0)*(s*s*s)*3.6E1+dx1*dx2*(l0*l0*l0*l0)*(s*s)*2.2E1+dy1*dy2*(l0*l0)*(s*s*s*s)*1.8E1-dy1*dy2*(l0*l0*l0)*(s*s*s)*3.6E1+dy1*dy2*(l0*l0*l0*l0)*(s*s)*2.2E1-dx1*(l0*l0)*(s*s*s)*x1*8.4E1+dx1*(l0*l0*l0)*(s*s)*x1*6.0E1+dx1*(l0*l0)*(s*s*s)*x2*8.4E1-dx1*(l0*l0*l0)*(s*s)*x2*6.0E1-dx2*(l0*l0)*(s*s*s)*x1*6.0E1+dx2*(l0*l0*l0)*(s*s)*x1*2.4E1+dx2*(l0*l0)*(s*s*s)*x2*6.0E1-dx2*(l0*l0*l0)*(s*s)*x2*2.4E1-dy1*(l0*l0)*(s*s*s)*y1*8.4E1+dy1*(l0*l0*l0)*(s*s)*y1*6.0E1+dy1*(l0*l0)*(s*s*s)*y2*8.4E1-dy1*(l0*l0*l0)*(s*s)*y2*6.0E1-dy2*(l0*l0)*(s*s*s)*y1*6.0E1+dy2*(l0*l0*l0)*(s*s)*y1*2.4E1+dy2*(l0*l0)*(s*s*s)*y2*6.0E1-dy2*(l0*l0*l0)*(s*s)*y2*2.4E1-(l0*l0)*(s*s)*x1*x2*7.2E1-(l0*l0)*(s*s)*y1*y2*7.2E1);

    return b.copy();
  }

}

